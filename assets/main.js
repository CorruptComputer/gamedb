function isIterable(e){return null!=e&&"function"==typeof e[Symbol.iterator]}function isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}function toast(e=!0,t,a="",n=0,r=""){0===n&&(n=8),-1===n&&(n=0);const o={onclick:r?function(){"refresh"===r&&location.reload()}:null,newestOnTop:!0,preventDuplicates:!1,progressBar:!0,timeOut:1e3*n,extendedTimeOut:1e3*n};e?toastr.success(t,a,o):toastr.error(t,a,o)}function highLightOwnedGames(){if(user.isLoggedIn){let e=localStorage.getItem("games");null!=e&&null!=(e=JSON.parse(e))&&$("[data-app-id]").each(function(){const t=$(this).attr("data-app-id");-1!==e.indexOf(parseInt(t))&&$(this).addClass("font-weight-bold")})}}!function(e){"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){function t(e,t,a){var n=a[e];return void 0===n?a[e]=[t]:n.push(t),a}var a={checked:["radio","checkbox"],selected:["option","select-one","select-multiple"],value:["button","color","date","datetime","datetime-local","email","hidden","month","number","password","range","reset","search","submit","tel","text","textarea","time","url","week"]};function n(t,n,r,o,s){var i=function(t){var n=function(e){return(e.type||e.nodeName).toLowerCase()}(t),r=void 0;return e.each(a,function(t,a){if(e.inArray(n,a)>-1)return r=t,!1}),r}(t);if("value"==i&&n==o)t.value=r,s.call(t,r);else if("checked"==i||"selected"==i){var l=[];t.options?e.each(t.options,function(e,t){l.push(t)}):l.push(t),t.multiple&&0==o&&(t.selectedIndex=-1),e.each(l,function(e,t){t.value==r&&(t[i]=!0,s.call(t,r))})}}var r={change:e.noop,complete:e.noop};e.fn.deserialize=function(a,o){e.isFunction(o)&&(o={complete:o}),o=e.extend(r,o||{}),a=function(a){var n={},r=/\+/g;return e.isPlainObject(a)?(e.extend(n,a),e.each(n,function(t,a){e.isArray(a)||(n[t]=[a])})):e.isArray(a)?e.each(a,function(e,a){t(a.name,a.value,n)}):"string"==typeof a&&e.each(a.split("&"),function(e,a){var o=a.split("=");t(decodeURIComponent(o[0].replace(r,"%20")),decodeURIComponent(o[1].replace(r,"%20")),n)}),n}(a);var s=function(a,n){var r={},o=a.map(function(){return this.elements?e.makeArray(this.elements):this}).filter(n||":input:not(:disabled)").get();return e.each(o,function(e,a){t(a.name,a,r)}),r}(this,o.filter);return e.each(a,function(t,a){e.each(s[t],function(t,r){e.each(a,function(e,a){n(r,t,a,e,o.change)})})}),o.complete.call(this),this}}),function(e){jQuery.fn.doubleScroll=function(t){var a={contentElement:void 0,scrollCss:{"overflow-x":"auto","overflow-y":"hidden",height:"20px"},contentCss:{"overflow-x":"auto","overflow-y":"hidden"},onlyIfScroll:!0,resetOnWindowResize:!1,timeToWaitForResize:30};e.extend(!0,a,t),e.extend(a,{topScrollBarMarkup:'<div class="doubleScroll-scroll-wrapper"><div class="doubleScroll-scroll"></div></div>',topScrollBarWrapperSelector:".doubleScroll-scroll-wrapper",topScrollBarInnerSelector:".doubleScroll-scroll"});var n=function(t,a){if(a.onlyIfScroll&&t.get(0).scrollWidth<=t.width())t.prev(a.topScrollBarWrapperSelector).remove();else{var n,r=t.prev(a.topScrollBarWrapperSelector);if(0==r.length){r=e(a.topScrollBarMarkup),t.before(r),r.css(a.scrollCss),e(a.topScrollBarInnerSelector).css("height","20px"),t.css(a.contentCss),r.bind("scroll.doubleScroll",function(){t.scrollLeft(r.scrollLeft())});t.bind("scroll.doubleScroll",function(){r.scrollLeft(t.scrollLeft())})}n=void 0!==a.contentElement&&0!==t.find(a.contentElement).length?t.find(a.contentElement):t.find(">:first-child"),e(a.topScrollBarInnerSelector,r).width(n.outerWidth()),r.width(t.width()),r.scrollLeft(t.scrollLeft())}};return this.each(function(){var t=e(this);if(n(t,a),a.resetOnWindowResize){var r,o=function(e){n(t,a)};e(window).bind("resize.doubleScroll",function(){clearTimeout(r),r=setTimeout(o,a.timeToWaitForResize)})}})}}(jQuery),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.StickySidebar=t()}(this,function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var a=t(function(e,t){!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t,a,n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=(t=".stickySidebar",a={topSpacing:0,bottomSpacing:0,containerSelector:!1,innerWrapperSelector:".inner-wrapper-sticky",stickyClass:"is-affixed",resizeSensor:!0,minWidth:!1},function(){function e(t){var n=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(function(t,a){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.options=e.extend(a,r),this.sidebar="string"==typeof t?document.querySelector(t):t,void 0===this.sidebar)throw new Error("There is no specific sidebar element.");this.sidebarInner=!1,this.container=this.sidebar.parentElement,this.affixedType="STATIC",this.direction="down",this.support={transform:!1,transform3d:!1},this._initialized=!1,this._reStyle=!1,this._breakpoint=!1,this.dimensions={translateY:0,maxTranslateY:0,topSpacing:0,lastTopSpacing:0,bottomSpacing:0,lastBottomSpacing:0,sidebarHeight:0,sidebarWidth:0,containerTop:0,containerHeight:0,viewportHeight:0,viewportTop:0,lastViewportTop:0},["handleEvent"].forEach(function(e){n[e]=n[e].bind(n)}),this.initialize()}return n(e,[{key:"initialize",value:function(){var e=this;if(this._setSupportFeatures(),this.options.innerWrapperSelector&&(this.sidebarInner=this.sidebar.querySelector(this.options.innerWrapperSelector),null===this.sidebarInner&&(this.sidebarInner=!1)),!this.sidebarInner){var t=document.createElement("div");for(t.setAttribute("class","inner-wrapper-sticky"),this.sidebar.appendChild(t);this.sidebar.firstChild!=t;)t.appendChild(this.sidebar.firstChild);this.sidebarInner=this.sidebar.querySelector(".inner-wrapper-sticky")}if(this.options.containerSelector){var a=document.querySelectorAll(this.options.containerSelector);if((a=Array.prototype.slice.call(a)).forEach(function(t,a){t.contains(e.sidebar)&&(e.container=t)}),!a.length)throw new Error("The container does not contains on the sidebar.")}"function"!=typeof this.options.topSpacing&&(this.options.topSpacing=parseInt(this.options.topSpacing)||0),"function"!=typeof this.options.bottomSpacing&&(this.options.bottomSpacing=parseInt(this.options.bottomSpacing)||0),this._widthBreakpoint(),this.calcDimensions(),this.stickyPosition(),this.bindEvents(),this._initialized=!0}},{key:"bindEvents",value:function(){window.addEventListener("resize",this,{passive:!0,capture:!1}),window.addEventListener("scroll",this,{passive:!0,capture:!1}),this.sidebar.addEventListener("update"+t,this),this.options.resizeSensor&&"undefined"!=typeof ResizeSensor&&(new ResizeSensor(this.sidebarInner,this.handleEvent),new ResizeSensor(this.container,this.handleEvent))}},{key:"handleEvent",value:function(e){this.updateSticky(e)}},{key:"calcDimensions",value:function(){if(!this._breakpoint){var t=this.dimensions;t.containerTop=e.offsetRelative(this.container).top,t.containerHeight=this.container.clientHeight,t.containerBottom=t.containerTop+t.containerHeight,t.sidebarHeight=this.sidebarInner.offsetHeight,t.sidebarWidth=this.sidebarInner.offsetWidth,t.viewportHeight=window.innerHeight,t.maxTranslateY=t.containerHeight-t.sidebarHeight,this._calcDimensionsWithScroll()}}},{key:"_calcDimensionsWithScroll",value:function(){var t=this.dimensions;t.sidebarLeft=e.offsetRelative(this.sidebar).left,t.viewportTop=document.documentElement.scrollTop||document.body.scrollTop,t.viewportBottom=t.viewportTop+t.viewportHeight,t.viewportLeft=document.documentElement.scrollLeft||document.body.scrollLeft,t.topSpacing=this.options.topSpacing,t.bottomSpacing=this.options.bottomSpacing,"function"==typeof t.topSpacing&&(t.topSpacing=parseInt(t.topSpacing(this.sidebar))||0),"function"==typeof t.bottomSpacing&&(t.bottomSpacing=parseInt(t.bottomSpacing(this.sidebar))||0),"VIEWPORT-TOP"===this.affixedType?t.topSpacing<t.lastTopSpacing&&(t.translateY+=t.lastTopSpacing-t.topSpacing,this._reStyle=!0):"VIEWPORT-BOTTOM"===this.affixedType&&t.bottomSpacing<t.lastBottomSpacing&&(t.translateY+=t.lastBottomSpacing-t.bottomSpacing,this._reStyle=!0),t.lastTopSpacing=t.topSpacing,t.lastBottomSpacing=t.bottomSpacing}},{key:"isSidebarFitsViewport",value:function(){var e=this.dimensions,t="down"===this.scrollDirection?e.lastBottomSpacing:e.lastTopSpacing;return this.dimensions.sidebarHeight+t<this.dimensions.viewportHeight}},{key:"observeScrollDir",value:function(){var e=this.dimensions;if(e.lastViewportTop!==e.viewportTop){var t="down"===this.direction?Math.min:Math.max;e.viewportTop===t(e.viewportTop,e.lastViewportTop)&&(this.direction="down"===this.direction?"up":"down")}}},{key:"getAffixType",value:function(){this._calcDimensionsWithScroll();var e=this.dimensions,t=e.viewportTop+e.topSpacing,a=this.affixedType;return t<=e.containerTop||e.containerHeight<=e.sidebarHeight?(e.translateY=0,a="STATIC"):a="up"===this.direction?this._getAffixTypeScrollingUp():this._getAffixTypeScrollingDown(),e.translateY=Math.max(0,e.translateY),e.translateY=Math.min(e.containerHeight,e.translateY),e.translateY=Math.round(e.translateY),e.lastViewportTop=e.viewportTop,a}},{key:"_getAffixTypeScrollingDown",value:function(){var e=this.dimensions,t=e.sidebarHeight+e.containerTop,a=e.viewportTop+e.topSpacing,n=e.viewportBottom-e.bottomSpacing,r=this.affixedType;return this.isSidebarFitsViewport()?e.sidebarHeight+a>=e.containerBottom?(e.translateY=e.containerBottom-t,r="CONTAINER-BOTTOM"):a>=e.containerTop&&(e.translateY=a-e.containerTop,r="VIEWPORT-TOP"):e.containerBottom<=n?(e.translateY=e.containerBottom-t,r="CONTAINER-BOTTOM"):t+e.translateY<=n?(e.translateY=n-t,r="VIEWPORT-BOTTOM"):e.containerTop+e.translateY<=a&&0!==e.translateY&&e.maxTranslateY!==e.translateY&&(r="VIEWPORT-UNBOTTOM"),r}},{key:"_getAffixTypeScrollingUp",value:function(){var e=this.dimensions,t=e.sidebarHeight+e.containerTop,a=e.viewportTop+e.topSpacing,n=e.viewportBottom-e.bottomSpacing,r=this.affixedType;return a<=e.translateY+e.containerTop?(e.translateY=a-e.containerTop,r="VIEWPORT-TOP"):e.containerBottom<=n?(e.translateY=e.containerBottom-t,r="CONTAINER-BOTTOM"):this.isSidebarFitsViewport()||e.containerTop<=a&&0!==e.translateY&&e.maxTranslateY!==e.translateY&&(r="VIEWPORT-UNBOTTOM"),r}},{key:"_getStyle",value:function(t){if(void 0!==t){var a={inner:{},outer:{}},n=this.dimensions;switch(t){case"VIEWPORT-TOP":a.inner={position:"fixed",top:n.topSpacing,left:n.sidebarLeft-n.viewportLeft,width:n.sidebarWidth};break;case"VIEWPORT-BOTTOM":a.inner={position:"fixed",top:"auto",left:n.sidebarLeft,bottom:n.bottomSpacing,width:n.sidebarWidth};break;case"CONTAINER-BOTTOM":case"VIEWPORT-UNBOTTOM":var r=this._getTranslate(0,n.translateY+"px");a.inner=r?{transform:r}:{position:"absolute",top:n.translateY,width:n.sidebarWidth}}switch(t){case"VIEWPORT-TOP":case"VIEWPORT-BOTTOM":case"VIEWPORT-UNBOTTOM":case"CONTAINER-BOTTOM":a.outer={height:n.sidebarHeight,position:"relative"}}return a.outer=e.extend({height:"",position:""},a.outer),a.inner=e.extend({position:"relative",top:"",left:"",bottom:"",width:"",transform:""},a.inner),a}}},{key:"stickyPosition",value:function(a){if(!this._breakpoint){a=this._reStyle||a||!1,this.options.topSpacing,this.options.bottomSpacing;var n=this.getAffixType(),r=this._getStyle(n);if((this.affixedType!=n||a)&&n){var o="affix."+n.toLowerCase().replace("viewport-","")+t;for(var s in e.eventTrigger(this.sidebar,o),"STATIC"===n?e.removeClass(this.sidebar,this.options.stickyClass):e.addClass(this.sidebar,this.options.stickyClass),r.outer){var i="number"==typeof r.outer[s]?"px":"";this.sidebar.style[s]=r.outer[s]+i}for(var l in r.inner){var c="number"==typeof r.inner[l]?"px":"";this.sidebarInner.style[l]=r.inner[l]+c}var d="affixed."+n.toLowerCase().replace("viewport-","")+t;e.eventTrigger(this.sidebar,d)}else this._initialized&&(this.sidebarInner.style.left=r.inner.left);this.affixedType=n}}},{key:"_widthBreakpoint",value:function(){window.innerWidth<=this.options.minWidth?(this._breakpoint=!0,this.affixedType="STATIC",this.sidebar.removeAttribute("style"),e.removeClass(this.sidebar,this.options.stickyClass),this.sidebarInner.removeAttribute("style")):this._breakpoint=!1}},{key:"updateSticky",value:function(){var e,t=this,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._running||(this._running=!0,e=a.type,requestAnimationFrame(function(){switch(e){case"scroll":t._calcDimensionsWithScroll(),t.observeScrollDir(),t.stickyPosition();break;case"resize":default:t._widthBreakpoint(),t.calcDimensions(),t.stickyPosition(!0)}t._running=!1}))}},{key:"_setSupportFeatures",value:function(){var t=this.support;t.transform=e.supportTransform(),t.transform3d=e.supportTransform(!0)}},{key:"_getTranslate",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return this.support.transform3d?"translate3d("+e+", "+t+", "+a+")":!!this.support.translate&&"translate("+e+", "+t+")"}},{key:"destroy",value:function(){window.removeEventListener("resize",this,{capture:!1}),window.removeEventListener("scroll",this,{capture:!1}),this.sidebar.classList.remove(this.options.stickyClass),this.sidebar.style.minHeight="",this.sidebar.removeEventListener("update"+t,this);var e={inner:{},outer:{}};for(var a in e.inner={position:"",top:"",left:"",bottom:"",width:"",transform:""},e.outer={height:"",position:""},e.outer)this.sidebar.style[a]=e.outer[a];for(var n in e.inner)this.sidebarInner.style[n]=e.inner[n];this.options.resizeSensor&&"undefined"!=typeof ResizeSensor&&(ResizeSensor.detach(this.sidebarInner,this.handleEvent),ResizeSensor.detach(this.container,this.handleEvent))}}],[{key:"supportTransform",value:function(e){var t=!1,a=e?"perspective":"transform",n=a.charAt(0).toUpperCase()+a.slice(1),r=document.createElement("support").style;return(a+" "+["Webkit","Moz","O","ms"].join(n+" ")+n).split(" ").forEach(function(e,a){if(void 0!==r[e])return t=e,!1}),t}},{key:"eventTrigger",value:function(e,t,a){try{var n=new CustomEvent(t,{detail:a})}catch(e){(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a)}e.dispatchEvent(n)}},{key:"extend",value:function(e,t){var a={};for(var n in e)void 0!==t[n]?a[n]=t[n]:a[n]=e[n];return a}},{key:"offsetRelative",value:function(e){var t={left:0,top:0};do{var a=e.offsetTop,n=e.offsetLeft;isNaN(a)||(t.top+=a),isNaN(n)||(t.left+=n),e="BODY"===e.tagName?e.parentElement:e.offsetParent}while(e);return t}},{key:"addClass",value:function(t,a){e.hasClass(t,a)||(t.classList?t.classList.add(a):t.className+=" "+a)}},{key:"removeClass",value:function(t,a){e.hasClass(t,a)&&(t.classList?t.classList.remove(a):t.className=t.className.replace(new RegExp("(^|\\b)"+a.split(" ").join("|")+"(\\b|$)","gi")," "))}},{key:"hasClass",value:function(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)}},{key:"defaults",get:function(){return a}}]),e}());e.default=r,window.StickySidebar=r}(t)});return e(a),e(t(function(e,t){!function(e){var t,n=(t=a)&&t.__esModule?t:{default:t};!function(){if("undefined"!=typeof window){var e=window.$||window.jQuery||window.Zepto,t="stickySidebar";if(e){e.fn.stickySidebar=function(a){return this.each(function(){var r=e(this),o=e(this).data(t);if(o||(o=new n.default(this,"object"==typeof a&&a),r.data(t,o)),"string"==typeof a){if(void 0===o[a]&&-1===["destroy","updateSticky"].indexOf(a))throw new Error('No method named "'+a+'"');o[a]()}})},e.fn.stickySidebar.Constructor=n.default;var a=e.fn.stickySidebar;e.fn.stickySidebar.noConflict=function(){return e.fn.stickySidebar=a,this}}}}()}()}))});const $document=$(document),$body=$("body");let dataLinkDrag=!1,dataLinkX=0,dataLinkY=0;function isJson(e){try{JSON.parse(e)}catch(e){return!1}return!0}$document.on("mousedown","[data-link]",function(e){dataLinkX=e.screenX,dataLinkY=e.screenY,dataLinkDrag=!1}),$document.on("mousemove","[data-link]",function(e){!dataLinkDrag&&(Math.abs(dataLinkX-e.screenX)>5||Math.abs(dataLinkY-e.screenY)>5)&&(dataLinkDrag=!0)}),$(document).on("mouseup","[data-link]",function(e){e.stopPropagation();const t=$(this).attr("data-link"),a=$(this).attr("data-target");return!t||(!!dataLinkDrag||(3===e.which||(e.ctrlKey||e.shiftKey||e.metaKey||2===e.which||"_blank"===a?($(e.target).is("a")||window.open(t,"_blank"),!0):(window.location.href=t,!0))))}),$(document).on("mouseup","[data-link] a",function(e){return e.stopPropagation(),!0}),$(".stop-prop").on("click",function(e){e.stopPropagation()}),$(".navbar .dropdown").hover(function(){$(this).addClass("show").find(".dropdown-menu").addClass("show")},function(){$(this).removeClass("show").find(".dropdown-menu").removeClass("show")}).click(function(e){e.stopPropagation()}),$body.tooltip({selector:'[data-toggle="tooltip"]'}),$(".json").each(function(e,t){const a=$(this).text();if(isJson(a)){const e=JSON.parse(a);$(this).text(JSON.stringify(e,null,"  "))}}),function(e,t){"use strict";e(document).ready(function(){const a=t.location.hash;if(a){let t="";a.split(/[,\-]/).map(function(a){e('.nav-link[href="'+(t=""===t?a:t+"-"+a)+'"]').tab("show")})}e('a[data-toggle="tab"]').on("shown.bs.tab",function(t){const a=e(t.target).attr("href");history.pushState?history.pushState(null,null,a):location.hash=a})})}(jQuery,window);const $top=$("#top");function websocketListener(e,t){if(void 0===window.WebSocket)console.log("Your browser does not support websockets");else{const a=new WebSocket(("https:"===location.protocol?"wss://gamedb.online":"ws://"+location.host)+"/websocket/"+e),n=$("#live-badge");let r=!1;a.onopen=function(e){n.addClass("badge-success").removeClass("badge-secondary badge-danger"),console.log("Websocket opened"),r=!0},a.onclose=function(e){r&&(n.addClass("badge-danger").removeClass("badge-secondary badge-success"),toast(!1,"Live functionality has stopped"),console.log("Websocket closed"))},a.onerror=function(e){r&&(n.addClass("badge-danger").removeClass("badge-secondary badge-success"),toast(!1,"Live functionality has stopped"))},a.onmessage=function(e){return t(e)}}}if($(window).on("scroll",function(e){$(window).scrollTop()>=1e3?$top.addClass("show"):$top.removeClass("show")}),$top.click(function(e){$("html, body").animate({scrollTop:0},500)}),highLightOwnedGames(),isIterable(user.toasts))for(const e of user.toasts)toast(e.success,e.message,e.title,e.timeout,e.link);function fixBrokenImages(){$("img").one("error",function(){const e=$(this).attr("data-src");e&&(this.src=e)}),$('img[src=""][data-src]').each(function(e,t){this.src=$(this).attr("data-src")})}$(document).ready(function(){const e=$("#app-page, #package-page, #player-page, #bundle-page, #group-page").attr("data-path");e&&e!==window.location.pathname&&history.replaceState(null,null,e+window.location.hash)}),$(document).ready(fixBrokenImages);const $dataTables=$("table.table-datatable"),$dataTables2=$("table.table-datatable2");let dataTables=[];const $lockIcon='<i class="fa fa-lock text-muted" data-toggle="tooltip" data-placement="left" title="Private"></i>';$dataTables.each(function(e){const t=[];$(this).find("thead tr th[data-disabled]").each(function(e){t.push($(this).index())});const a=$(this).DataTable({pageLength:100,paging:!0,ordering:!0,fixedHeader:!0,info:!1,searching:!0,search:{smart:!0},autoWidth:!1,lengthChange:!1,stateSave:!1,dom:'<"dt-pagination"p>t<"dt-pagination"p>',columnDefs:[{targets:t,orderable:!1}],drawCallback:function(e,t){this.api().page.info().pages<=1&&$(this).parent().find(".dt-pagination").hide()},initComplete:function(e,t){$("table.table-datatable").on("order.dt",function(e,t,a){$("#live-badge").trigger("click")})}});dataTables.push(a)});const $searchField=$("input#search");function getPagingType(){return user.userLevel,"simple_numbers"}$searchField.on("keyup",function(e){$dataTables.DataTable().search($(this).val()).draw()}),$searchField.on("keyup",function(e){$(this).val()&&"Escape"===e.key&&($(this).val(""),$dataTables.DataTable().search($(this).val()).draw(),$dataTables2.DataTable().search($(this).val()).draw())}),$dataTables.on("page.dt",function(e,t,a){let n=15;$(".fixedHeader-floating").length>0&&(n+=48),$("html, body").animate({scrollTop:$(this).prev().offset().top-n},200)}),$dataTables.on("draw.dt",function(e,t){fixBrokenImages()});const dtDefaultOptions={ajax:function(e,t,a,n=null){let r=$(this);n&&(r=n),$.ajax({url:function(){const e=r.attr("data-path");return!e&&user.isLocal&&console.log("Table data-path not set"),e}(),data:e,success:function(e,a,n){if(t(e,a,n),e.limited){const e=$("li.paginate_button.page-item.next.disabled").length>0?"font-weight-bold":"",t=$('<li class="donate"><small><a href="/donate"><i class="fas fa-heart text-danger"></i> <span class="'+e+'">See more!</span></a></small></li>');r.parent().find(".dt-pagination ul.pagination").append(t)}},error:function(e,a,n){t({draw:"1",recordsTotal:"0",recordsFiltered:"0",data:[],limited:!1},a,null)},dataType:"json",cache:"false"!==r.attr("data-cache")})},processing:!0,serverSide:!0,pageLength:100,fixedHeader:!0,paging:!0,ordering:!0,info:!1,searching:!0,autoWidth:!1,lengthChange:!1,stateSave:!1,orderMulti:!1,pagingType:getPagingType(),dom:'<"dt-pagination"p>t<"dt-pagination"p>r',language:{processing:'<i class="fas fa-spinner fa-spin fa-3x fa-fw"></i>'},drawCallback:function(e,t){this.api().page.info().pages<=1&&$(this).parent().find(".dt-pagination").hide(),$(".paginate_button > a").on("focus",function(){$(this).blur()})},initComplete:function(e,t){$dataTables2.on("order.dt",function(e,t,a){$("#live-badge").trigger("click")})}};function addDataTablesRow(e,t,a,n){let r=$('<tr class="fade-green" />');if(e.createdRow(r[0],t,null),isIterable(e.columnDefs))for(const a of e.columnDefs){let e=t[a];"render"in a&&(e=a.render(null,null,t));const n=$("<td />").html(e);"createdCell"in a&&a.createdCell(n,null,t,null,null),n.find("[data-livestamp]").html("a few seconds ago"),r.append(n)}n.prepend(r),n.find("tbody tr").slice(a).remove()}$dataTables2.filter(":not(.table-no-fade)").on("page.dt search.dt",function(e,t,a){$(this).fadeTo(500,.3)}).on("draw.dt",function(e,t,a){$(this).fadeTo(100,1)}),$dataTables2.on("page.dt",function(e,t,a){$("html, body").animate({scrollTop:$(this).prev().offset().top-15},200)}),$dataTables2.on("draw.dt",function(e,t,a){highLightOwnedGames(),fixBrokenImages()});const $priceChart=$("#app-page #prices-chart, #package-page #prices-chart");if($priceChart.length>0&&prices){let e,t;function upateChart(a){t&&t.abort(),$("tr[data-code]").removeClass("font-weight-bold").attr("data-link",""),$("tr[data-code="+a+"]").addClass("font-weight-bold").removeAttr("data-link"),e.showLoading(),t=$.ajax({type:"GET",data:{code:a},url:$priceChart.attr("data-ajax"),dataType:"json",cache:!0,success:function(t,a,n){"prices"in t&&(e.series[0].setData(t.prices),e.yAxis[0].update({title:{text:"Price ("+t.symbol+")"}}),e.hideLoading())}})}function loadPriceChart(){e=Highcharts.chart("prices-chart",{chart:{zoomType:"x",backgroundColor:"rgba(0,0,0,0)"},title:{text:""},subtitle:{text:""},xAxis:{title:{text:"Date"},type:"datetime",labels:{step:1,formatter:function(){return moment(this.value).format("Do MMM YY")}}},yAxis:{title:{text:"Price ($)"},type:"linear",min:0,allowDecimals:!0},legend:{enabled:!1},credits:{enabled:!1},series:[{type:"line",name:"Price",step:"left",color:"#28a745"}],annotations:[{labelOptions:{backgroundColor:"rgba(255,255,255,0.5)",verticalAlign:"top",y:15},labels:[{point:{xAxis:0,yAxis:0,x:27.98,y:255},text:"Arbois"},{point:{xAxis:0,yAxis:0,x:45.5,y:611},text:"Montrond"},{point:{xAxis:0,yAxis:0,x:63,y:651},text:"Mont-sur-Monnet"}]}]}),upateChart(user.userCountry)}$("#prices tr[data-code]").on("click",function(e){$(this).hasClass("font-weight-bold")||upateChart($(this).attr("data-code"))})}const $apiPage=$("#api-page");if($apiPage.length>0&&($("#sidebar").stickySidebar({topSpacing:0,bottomSpacing:16}),$(".endpoint").on("mouseenter",function(){$(this).select()})),$("#admin-page").length>0){$("#actions a").on("click",function(){return confirm("Are you sure?")});const e=$("form#queues");e.on("submit",function(t){t.preventDefault(),$.ajax({type:"post",url:e.attr("action"),data:$(this).serialize(),success:function(t,a,n){toast(!0,"Queued"),e.trigger("reset")}})}),websocketListener("admin",function(e){toast(!0,$.parseJSON(e.data).Data.message,"",0)})}const $appPage=$("#app-page");if($appPage.length>0){$("#news-modal");const e=$("#details img");function resetVideos(){$("video").each(function(e){$(this)[0].pause(),$(this)[0].currentTime=0})}function loadMedia(){const e=$("#carousel1"),t=$("#carousel2");e.slick({waitForAnimate:!1,arrows:!1,autoplay:!1,dots:!1,asNavFor:t,adaptiveHeight:!0,lazyLoad:"ondemand"}),t.slick({waitForAnimate:!1,arrows:!1,slidesToShow:15,autoplay:!1,dots:!1,variableWidth:!0,asNavFor:e,focusOnSelect:!0,centerMode:!0,infinite:!0}),e.on("afterChange",function(t,a,n){resetVideos();const r=e.find("div[data-slick-index="+n+"] video");r.length>0&&r[0].play()}),$(document).on("keydown",function(t){$('a.active[href="#media"]').length>0&&(37===t.keyCode&&e.slick("slickPrev"),39===t.keyCode&&e.slick("slickNext"))})}function loadNews(){const e=$("#news-table"),t=e.DataTable($.extend(!0,{},dtDefaultOptions,{order:[[2,"desc"]],createdRow:function(e,t,a){$(e).attr("data-id",t[0])},columnDefs:[{targets:0,render:function(e,t,a){return'<div><i class="fas fa-newspaper"></i> '+a[1]+'</div><div class="d-none">'+a[5]+"</div>"},orderable:!1},{targets:1,render:function(e,t,a){return a[2]},orderable:!1},{targets:2,render:function(e,t,a){return'<span data-toggle="tooltip" data-placement="left" title="'+a[4]+'" data-livestamp="'+a[3]+'"></span>'},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1}]}));dataTables.push(t),e.on("click","tr[role=row]",function(){const e=t.row($(this));e.child.isShown()?(e.child.hide(),$(this).removeClass("shown")):(e.child($("<div/>").html(e.data()[5]).text()).show(),$(this).addClass("shown"))}),$("#news a").each(function(){const e=$(this).attr("href");e&&!e.startsWith("http")&&$(this).attr("href","http://"+e)})}e.on("click",function(){$('.card-header-tabs a[href="#media"]').tab("show")}),e.on("error",function(){$(this).attr("src","/assets/img/no-app-image-banner.jpg"),$(this).hide()}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){const t=$(e.target),a=$(e.relatedTarget);"#media"===t.attr("href")&&(t.attr("loaded")||(t.attr("loaded",1),loadMedia())),"#news"===t.attr("href")&&(t.attr("loaded")||(t.attr("loaded",1),loadNews())),"#prices"===t.attr("href")&&(t.attr("loaded")||(t.attr("loaded",1),loadPriceChart())),"#players"===t.attr("href")&&(t.attr("loaded")||(t.attr("loaded",1),loadAppPlayersChart(),loadAppPlayerTimes())),"#reviews"===t.attr("href")&&(t.attr("loaded")||(t.attr("loaded",1),loadAppReviewsChart())),"#media"===a.attr("href")&&resetVideos(),$.each(dataTables,function(e,t){t.fixedHeader.adjust()})}),websocketListener("app",function(e){$.parseJSON(e.data).Data.toString()===$appPage.attr("data-id")&&toast(!0,"Click to refresh","This app has been updated",-1,"refresh")});const t={chart:{backgroundColor:"rgba(0,0,0,0)"},title:{text:""},subtitle:{text:""},credits:{enabled:!1},plotOptions:{},xAxis:{title:{text:""},type:"datetime"}};function loadAppReviewsChart(){$.ajax({type:"GET",url:"/apps/"+$appPage.attr("data-id")+"/reviews.json",dataType:"json",success:function(e,a,n){null===e&&(e=[]),Highcharts.chart("reviews-chart",$.extend(!0,{},t,{chart:{type:"line"},yAxis:[{allowDecimals:!1,title:{text:""},min:0,max:100,endOnTick:!1,labels:{formatter:function(){return this.value+"%"}}},{allowDecimals:!1,title:{text:""},opposite:!0,min:0}],legend:{enabled:!0},tooltip:{formatter:function(){const e=moment(this.key).format("DD MMM YYYY @ HH:mm");return"score"===this.series.name?this.y.toLocaleString()+"% score on "+e:"positive"===this.series.name?this.y.toLocaleString()+" positive reviews on "+e:"negative"===this.series.name?this.y.toLocaleString()+" negative reviews on "+e:void 0}},series:[{name:"score",color:"#28a745",data:e.mean_reviews_score,yAxis:0,marker:{symbol:"circle"}},{name:"positive",color:"#e83e8c",data:e.mean_reviews_positive,yAxis:1,marker:{symbol:"circle"}},{name:"negative",color:"#007bff",data:e.mean_reviews_negative,yAxis:1,marker:{symbol:"circle"}}]}))}})}function loadAppPlayersChart(){const e={chart:{backgroundColor:"rgba(0,0,0,0)"},title:{text:""},subtitle:{text:""},credits:{enabled:!1},xAxis:{title:{text:""},type:"datetime"}};$.ajax({type:"GET",url:"/apps/"+$appPage.attr("data-id")+"/players.json",dataType:"json",success:function(t,a,n){if(null===t){const e=Date.now();t={max_player_count:[[e,0]],max_twitch_viewers:[[e,0]]}}Highcharts.chart("players-chart",$.extend(!0,{},e,{chart:{type:"area"},yAxis:[{allowDecimals:!1,title:{text:""},min:0,labels:{formatter:function(){return this.value.toLocaleString()}}},{allowDecimals:!1,title:{text:""},min:0,opposite:!0,labels:{formatter:function(){return this.value.toLocaleString()}}}],legend:{enabled:!1},tooltip:{formatter:function(){return"Players"===this.series.name?this.y.toLocaleString()+" players on "+moment(this.key).format("DD MMM YYYY @ HH:mm"):this.y.toLocaleString()+" Twitch viewers on "+moment(this.key).format("DD MMM YYYY @ HH:mm")}},series:[{name:"Players",color:"#28a745",data:t.max_player_count,yAxis:0},{name:"Viewers",color:"#6441A4",data:t.max_twitch_viewers,yAxis:1,type:"line"}]}))}})}function loadAppPlayerTimes(){const e=$("#top-players-table").DataTable($.extend(!0,{},dtDefaultOptions,{order:[[3,"desc"]],createdRow:function(e,t,a){$(e).attr("data-id",t[0]),$(e).attr("data-link",t[6])},columnDefs:[{targets:0,render:function(e,t,a){return a[4]},createdCell:function(e,t,a,n,r){$(e).addClass("font-weight-bold")},orderable:!1},{targets:1,render:function(e,t,a){return a[3]?'<img data-toggle="tooltip" data-placement="left" title="'+a[7]+'" src="'+a[3]+'" class="rounded" alt="'+a[7]+'">':""},createdCell:function(e,t,a,n,r){$(e).addClass("img")},orderable:!1},{targets:2,render:function(e,t,a){return'<img src="'+a[5]+'" class="rounded square" alt="'+a[1]+'"><span>'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img"),$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(e,t,a){return a[2]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1}]}));dataTables.push(e)}}if($("#apps-page").length>0){$("#user-currency-symbol").append(" "+user.userCurrencySymbol);const e=$("select.form-control-chosen"),t=$("table.table-datatable2"),a=$("form");window.location.search&&a.deserialize(window.location.search.substr(1)),e.chosen({disable_search_threshold:10,allow_single_deselect:!0,rtl:!1,max_selected_options:10});const n=$("#price-low").val(),r=$("#price-high").val(),o=$("#price-slider")[0],s=noUiSlider.create(o,{start:[parseInt(n||0),parseInt(r||100)],connect:!0,step:1,range:{min:0,max:100}}),i=$("#score-low").val(),l=$("#score-high").val(),c=$("#score-slider")[0],d=noUiSlider.create(c,{start:[parseInt(i||0),parseInt(l||100)],connect:!0,step:1,range:{min:0,max:100}});function onPriceChange(e){const t=s.get();$("#price-low").val(t[0]),$("#price-high").val(t[1]),redrawTable()}function onScoreChange(e){const t=d.get();$("#score-low").val(t[0]),$("#score-high").val(t[1]),redrawTable()}function redrawTable(e){let n=a.serializeArray();return n=$.grep(n,function(e){return""!==e.value}),t.DataTable().draw(),history.pushState({},document.title,"/apps?"+$.param(n)),updateLabels(e),!1}function updateLabels(e){const t=s.get(),a=d.get();t[0]===t[1]?$("label#price-label").html("Price ("+user.userCurrencySymbol+Math.round(t[0])+")"):$("label#price-label").html("Price ("+user.userCurrencySymbol+Math.round(t[0])+" - "+user.userCurrencySymbol+Math.round(t[1])+")"),a[0]===a[1]?$("label#score-label").html("Score ("+Math.round(a[0])+"%)"):$("label#score-label").html("Score ("+Math.round(a[0])+"% - "+Math.round(a[1])+"%)")}e.on("change",redrawTable),a.on("submit",redrawTable),s.on("set",onPriceChange),s.on("update",updateLabels),d.on("set",onScoreChange),d.on("update",updateLabels),$(document).ready(updateLabels),t.DataTable($.extend(!0,{},dtDefaultOptions,{ajax:function(e,t,a){e.search.tags=$("#tags").val(),e.search.genres=$("#genres").val(),e.search.developers=$("#developers").val(),e.search.publishers=$("#publishers").val(),e.search.platforms=$("#platforms").val(),e.search.types=$("#types").val(),e.search.search=$("#search").val(),e.search.prices=s.get(),e.search.scores=d.get(),dtDefaultOptions.ajax(e,t,a,$(this))},order:[[2,"desc"]],createdRow:function(e,t,a){$(e).attr("data-app-id",t[0]),$(e).attr("data-link",t[3])},columnDefs:[{targets:0,render:function(e,t,a){return'<img src="'+a[2]+'" class="rounded square" alt="'+a[1]+'"><span>'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,t,a){return a[4]},createdCell:function(e,t,a,n,r){$(e).addClass("d-none d-lg-table-cell")},orderable:!1},{targets:2,render:function(e,t,a){return a[7].toLocaleString()},orderSequence:["desc"]},{targets:3,render:function(e,t,a){return a[5]+"%"},orderSequence:["desc"]},{targets:4,render:function(e,t,a){return a[6]},orderSequence:["desc"]}]}))}const $trendingAppsPage=$("#trending-apps-page"),$trendingAppsTable=$("table.table-datatable2");if($trendingAppsPage.length>0&&$trendingAppsTable.DataTable($.extend(!0,{},dtDefaultOptions,{order:[[3,"desc"]],createdRow:function(e,t,a){$(e).attr("data-app-id",t[0]),$(e).attr("data-link",t[3])},columnDefs:[{targets:0,render:function(e,t,a){return'<img src="'+a[2]+'" class="rounded square" alt="'+a[1]+'"><span>'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,t,a){return a[4]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,t,a){return a[6].toLocaleString()},orderSequence:["desc","asc"]},{targets:3,render:function(e,t,a){return a[5].toLocaleString()},orderSequence:["desc","asc"]},{targets:4,render:function(e,t,a){return'<div data-app-id="'+a[0]+'"><i class="fas fa-spinner fa-spin"></i></div>'},createdCell:function(e,t,a,n,r){$(e).addClass("chart")},orderable:!1}]})),$trendingAppsPage.length>0||$("#new-releases-page").length>0){function loadCharts(){const e=$("td.chart div[data-app-id]").map(function(){return $(this).attr("data-app-id")}).get().join(",");$.ajax({type:"GET",url:"/apps/trending/charts.json?ids="+e,dataType:"json",success:function(e,t,a){null!==e&&$("div[data-app-id]").each(function(t){let a={};const n=$(this).attr("data-app-id");a=null!==e&&n in e&&"max_player_count"in e[n]?e[n].max_player_count:[],Highcharts.chart(this,{chart:{type:"area",margin:[0,0,0,0],skipClone:!0,height:32,backgroundColor:"rgba(0,0,0,0)"},title:{text:""},subtitle:{text:""},credits:{enabled:!1},legend:{enabled:!1},xAxis:{title:{text:null},labels:{enabled:!1},type:"datetime"},yAxis:{title:{text:null},labels:{enabled:!1},min:0},plotOptions:{series:{marker:{enabled:!1}}},tooltip:{hideDelay:0,outside:!0,shared:!0,formatter:function(){return this.y.toLocaleString()+" players on "+moment(this.x).format("DD MMM YYYY @ HH:mm")},style:{width:"500px"}},series:[{color:"#28a745",data:a}]})})}})}$trendingAppsTable.on("draw.dt",function(e,t,a){loadCharts()})}const $badgePage=$("#badge-page");if($badgePage.length>0&&$("table.table-datatable2").DataTable($.extend(!0,{},dtDefaultOptions,{order:[[2,"desc"]],createdRow:function(e,t,a){$(e).attr("data-link",t[5])},columnDefs:[{targets:0,render:function(e,t,a){return a[0]}},{targets:1,render:function(e,t,a){return'<img src="'+a[2]+'" class="rounded square" alt="'+a[1]+'"><span>'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")}},{targets:2,render:function(e,t,a){return a[3].toLocaleString()}},{targets:3,render:function(e,t,a){return a[4]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")}}]})),$("#bundles-page").length>0){const e=$.extend(!0,{},dtDefaultOptions,{order:[[4,"desc"]],createdRow:function(e,t,a){$(e).attr("data-link",t[2])},columnDefs:[{targets:0,render:function(e,t,a){return'<img src="/assets/img/no-app-image-square.jpg" class="rounded square" alt="'+a[1]+'"><span>'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")}},{targets:1,render:function(e,t,a){return a[4]+"%"}},{targets:2,render:function(e,t,a){return a[5].toLocaleString()}},{targets:3,render:function(e,t,a){return a[6].toLocaleString()}},{targets:4,createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},render:function(e,t,a){return'<span data-livestamp="'+a[3]+'"></span>'}}]}),t=$("table.table-datatable2"),a=t.DataTable(e);websocketListener("bundles",function(n){const r=a.page.info();if(0===r.page){const a=$.parseJSON(n.data);addDataTablesRow(e,a.Data,r.length,t)}})}if($("#changes-page").length>0){const e=$.extend(!0,{},dtDefaultOptions,{order:[[1,"desc"]],createdRow:function(e,t,a){$(e).attr("data-link",t[5])},columnDefs:[{targets:0,render:function(e,t,a){return"Change "+a[0]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,t,a){return'<span data-toggle="tooltip" data-placement="left" title="'+a[2]+'" data-livestamp="'+a[1]+'"></span>'},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,t,a){let n=[];if(null!==a[3])for(let e in a[3])a[3].hasOwnProperty(e)&&(""===a[3][e].name&&(a[3][e].name="Unknown App"),n.push('<a href="'+a[3][e].path+'">'+a[3][e].name+"</a>"));return n.join("<br/>")},orderable:!1},{targets:3,render:function(e,t,a){let n=[];if(null!==a[4])for(let e in a[4])a[4].hasOwnProperty(e)&&(""===a[4][e].name&&(a[4][e].name="Unknown Package"),n.push('<a href="'+a[4][e].path+'">'+a[4][e].name+"</a>"));return n.join("<br/>")},orderable:!1}]}),t=$("table.table-datatable2"),a=t.DataTable(e);websocketListener("changes",function(n){const r=a.page.info();if(0===r.page){const a=$.parseJSON(n.data);if(isIterable(a.Data)){a.Data.sort(function(e,t){return Math.sign(e[0]-t[0])});for(const n of a.Data)addDataTablesRow(e,n,r.length,t)}}})}if($("#chat-page").length>0){const e=$("[data-channel-id]").attr("data-channel-id");function chatRow(e,t=!0){const a=$("ul[data-channel-id="+e.channel+"]");a.json2html(e,{"<>":"li",class:"media fade-in",style:"animation-delay: ${i}s",html:[{"<>":"img",class:"mr-3 rounded",src:"https://cdn.discordapp.com/avatars/${author_id}/${author_avatar}.png?size=64",alt:"${author_user}"},{"<>":"div",class:"media-body",html:[{"<>":"h5",class:function(){return"mt-0 mb-1 rounded"+(t?" fade-green":"")},html:"${content}"},{"<>":"p",class:"text-muted",html:'By ${author_user} at <span data-livestamp="${timestamp}"></span>'}]}]},{prepend:t}),a.find("li").slice(50).remove()}$.ajax({url:"/chat/"+e+"/chat.json",dataType:"json",cache:!1,success:function(e,t,a){if($(".fa-spin").remove(),isIterable(e))for(const t of e)chatRow(t,!1)}}),websocketListener("chat",function(e){chatRow($.parseJSON(e.data).Data)})}if($("#commits-page").length>0){const e=$("table#commits");let t=null;e.on("draw.dt",function(){t=null}),e.DataTable($.extend(!0,{},dtDefaultOptions,{order:[[1,"desc"]],createdRow:function(e,t,a){$(e).attr("data-link",t[3]),$(e).attr("data-target","_blank"),t[4]&&$(e).addClass("table-success",t[0])},columnDefs:[{targets:0,render:function(e,t,a){return a[0]},createdCell:function(e,t,a,n,r){$(e).attr("id",a[5]),$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,t,a){return'<span data-toggle="tooltip" data-placement="left" title="'+a[1]+'" data-livestamp="'+a[1]+'">'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,t,a){return a[5]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(a,n,r){return null===t&&(t=e.DataTable().page.info().page),r[2]||t>0?'<i class="fas fa-check"></i>':'<i class="fas fa-times"></i>'},orderable:!1}]}))}$("#contact-page").length,$("#coop-page").length>0&&($("form#add").submit(function(e){e.preventDefault();let t="";const a=$("input#id").val();t=document.location.href.indexOf("?")>=0?document.location.href+"&p="+a:document.location.href+"?p="+a,document.location=t}),$("#addme input").click(function(e){const t=$(this).attr("data-id");$("input#id").val(t),$("form#add").submit()}));const $xpPage=$("#experience-page");if($xpPage.length>0){function scroll(){if("string"==typeof scrollTo){const e=$(scrollTo).offset().top-100;$("html, body").animate({scrollTop:e},500),$("tr").removeClass("table-success"),$(scrollTo).addClass("table-success")}}function levelToXP(e){let t=0;for(let a=0;a<=e;a++)t+=100*Math.ceil(a/10);return t}function update(){const e=$("#answer");e.val("Loading..");let t=$("#from").val();t<1&&(t=1);let a=$("#to").val();a<1&&(a=1),e.val((levelToXP(a)-levelToXP(t)).toLocaleString())}$xpPage.on("click","tr[data-level]",function(e){const t=$(this).attr("data-level");history.pushState&&history.pushState("data","","/experience/"+t),scrollTo="tr[data-level="+t+"]",scroll()}),$("#from, #to").change(update),$("#calculate").click(function(e){e.preventDefault(),update()}),$(document).ready(scroll),$(document).ready(update)}const $groupPage=$("#group-page");if($groupPage.length>0&&(websocketListener("group",function(e){$.parseJSON(e.data).Data.toString()===$groupPage.attr("data-id")&&toast(!0,"Click to refresh","This group has been updated",-1,"refresh")}),$.ajax({type:"GET",url:"/groups/"+$groupPage.attr("data-id")+"/time.json",dataType:"json",success:function(e,t,a){null===e&&(e=[]);const n={allowDecimals:!1,title:{text:""},labels:{}};Highcharts.chart("chart",{chart:{type:"line",backgroundColor:"rgba(0,0,0,0)"},title:{text:""},subtitle:{text:""},credits:{enabled:!1},legend:{enabled:!1},plotOptions:{},xAxis:{title:{text:""},type:"datetime"},yAxis:[Object.assign({},n),Object.assign({},n),Object.assign({},n),Object.assign({},n)],tooltip:{formatter:function(){return this.y.toLocaleString()+" members on "+moment(this.key).format("dddd DD MMM YYYY @ HH:mm")}},series:[{name:"Members",color:"#28a745",data:e.max_members_count,marker:{symbol:"circle"},yAxis:0}]})}})),$("#groups-page").length>0){const e=$("table.table-datatable2");$("form").on("submit",function(t){return e.DataTable().draw(),!1}),$("#type, #errors").on("change",function(t){return e.DataTable().draw(),!1}),e.DataTable($.extend(!0,{},dtDefaultOptions,{ajax:function(e,t,a){e.search={},e.search.search=$("#search").val(),e.search.type=$("#type").val(),e.search.errors=$("#errors").val(),dtDefaultOptions.ajax(e,t,a,$(this))},order:[[2,"desc"]],createdRow:function(e,t,a){$(e).attr("data-link",t[2]),"game"!==t[7]||$("#type").val()||$(e).addClass("table-primary"),t[9]&&$(e).addClass("table-danger")},columnDefs:[{targets:0,render:function(e,t,a){return'<img data-src="/assets/img/no-app-image-square.jpg" src="'+a[3]+'" class="rounded square" alt="'+a[1]+'"><span>'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img"),$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,t,a){return a[4]},createdCell:function(e,t,a,n,r){$(e).addClass("d-none d-lg-table-cell")},orderable:!1},{targets:2,render:function(e,t,a){return a[5].toLocaleString()},orderable:!1},{targets:3,render:function(e,t,a){return'<a href="'+a[8]+'" target="_blank" rel="nofollow"><i class="fas fa-link" data-target="_blank"></i></a>'},orderable:!1}]}))}if($("#groups-trending-page").length>0){const e=$("table.table-datatable2");function loadCharts(){const e=$("td.chart div[data-group-id]").map(function(){return $(this).attr("data-group-id")}).get().join(",");$.ajax({type:"GET",url:"/groups/trending/charts.json?ids="+e,dataType:"json",success:function(e,t,a){null!==e&&$("div[data-group-id]").each(function(t){let a={};const n=$(this).attr("data-group-id");a=null!==e&&n in e&&"max_members_count"in e[n]?e[n].max_members_count:[],Highcharts.chart(this,{chart:{type:"area",margin:[0,0,0,0],skipClone:!0,height:32,backgroundColor:"rgba(0,0,0,0)"},title:{text:""},subtitle:{text:""},credits:{enabled:!1},legend:{enabled:!1},xAxis:{title:{text:null},labels:{enabled:!1},type:"datetime"},yAxis:{allowDecimals:!1,title:{text:null},labels:{enabled:!1}},plotOptions:{series:{marker:{enabled:!1}}},tooltip:{hideDelay:0,outside:!0,shared:!0,formatter:function(){return this.y.toLocaleString()+" members at "+moment(this.x).format("DD MMM YYYY @ HH:mm")},style:{width:"500px"}},series:[{color:"#28a745",data:a}]})})}})}$("form").on("submit",function(t){return e.DataTable().draw(),!1}),$("#type, #errors").on("change",function(t){return e.DataTable().draw(),!1}),e.DataTable($.extend(!0,{},dtDefaultOptions,{ajax:function(e,t,a){e.search={},e.search.search=$("#search").val(),e.search.type=$("#type").val(),e.search.errors=$("#errors").val(),dtDefaultOptions.ajax(e,t,a,$(this))},order:[[2,"desc"]],createdRow:function(e,t,a){$(e).attr("data-link",t[2]),"game"!==t[7]||$("#type").val()||$(e).addClass("table-primary"),t[9]&&$(e).addClass("table-danger")},columnDefs:[{targets:0,render:function(e,t,a){return'<img data-src="/assets/img/no-app-image-square.jpg" src="'+a[3]+'" class="rounded square" alt="'+a[1]+'"><span>'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img"),$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,t,a){return a[5].toLocaleString()},orderSequence:["desc"]},{targets:2,render:function(e,t,a){return a[10].toLocaleString()},orderSequence:["asc","desc"]},{targets:3,render:function(e,t,a){return'<a href="'+a[8]+'" target="_blank" rel="nofollow"><i class="fas fa-link" data-target="_blank"></i></a>'},orderable:!1}]})),$trendingAppsTable.on("draw.dt",function(e,t,a){loadCharts()})}if($("#home-page").length>0){function loadPlayers(e){$("#players .fa-spin").removeClass("d-none"),$("#players table").addClass("d-none"),$("[data-sort]").removeClass("badge-success"),$('[data-sort="'+e+'"]').addClass("badge-success"),$("#column").html(e),$.ajax({url:"/home/"+e+"/players.json",dataType:"json",cache:!1,success:function(e,t,a){if($("#players .fa-spin").addClass("d-none"),$("#players table").removeClass("d-none"),$("#players tbody tr").remove(),isIterable(e)){$("#players tbody").json2html(e,{"<>":"tr","data-link":"${link}",html:[{"<>":"td",class:"font-weight-bold",html:"${rank}"},{"<>":"td",class:"img",html:[{"<>":"img",src:"${avatar}",class:"rounded"},{"<>":"span",html:"${name}"}]},{"<>":"td",html:function(){return this.value.toLocaleString()}}]},{prepend:!1})}}})}function addPriceRow(e,t){const a=$("#prices tbody");a.json2html(e,{"<>":"tr","data-link":"${link}",html:[{"<>":"td",class:"img",html:[{"<>":"img",src:"${avatar}",class:"rounded"},{"<>":"span",html:"${name}",class:"text-truncate"}]},{"<>":"td",html:"${before}",nowrap:"nowrap"},{"<>":"td",html:"${after}",nowrap:"nowrap"},{"<>":"td",nowrap:"nowrap",html:[{"<>":"span","data-toggle":"tooltip","data-placement":"left","data-livestamp":"${time}"}]}]},{prepend:t}),a.find("tr").slice(15).remove()}$("[data-sort]").on("click",function(e){loadPlayers($(this).attr("data-sort"))}),loadPlayers("level"),$.ajax({url:"/home/prices.json",dataType:"json",cache:!1,success:function(e,t,a){if($("#prices .fa-spin").remove(),$("#prices table").removeClass("d-none"),isIterable(e))for(const t of e)addPriceRow(t,!1)}}),websocketListener("prices",function(e){addPriceRow($.parseJSON(e.data).Data,!0)})}$("#info-page").length>0&&$("#questions "+window.location.hash).addClass("highlight"),$("#login-page").length,$("#new-releases-page").length>0&&$("table.table-datatable2").DataTable($.extend(!0,{},dtDefaultOptions,{order:[[3,"desc"]],createdRow:function(e,t,a){$(e).attr("data-app-id",t[0]),$(e).attr("data-link",t[3])},columnDefs:[{targets:0,render:function(e,t,a){return'<img src="'+a[2]+'" class="rounded square" alt="'+a[1]+'"><span>'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")}},{targets:1,render:function(e,t,a){return a[5]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:2,render:function(e,t,a){return a[7]+"%"},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:3,render:function(e,t,a){return a[8].toLocaleString()},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:4,render:function(e,t,a){return a[6]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:5,render:function(e,t,a){return'<div data-app-id="'+a[0]+'"><i class="fas fa-spinner fa-spin"></i></div>'},createdCell:function(e,t,a,n,r){$(e).addClass("chart")},orderSequence:["desc","asc"]}]}));const $packagePage=$("#package-page");if($packagePage.length>0&&($('a[data-toggle="tab"]').on("shown.bs.tab",function(e){const t=$(e.target);$(e.relatedTarget);"#prices"===t.attr("href")&&(t.attr("loaded")||(t.attr("loaded",1),loadPriceChart())),$.each(dataTables,function(e,t){t.fixedHeader.adjust()})}),websocketListener("package",function(e){$.parseJSON(e.data).Data.toString()===$packagePage.attr("data-id")&&toast(!0,"Click to refresh","This package has been updated",-1,"refresh")})),$("#news-page").length>0){const e=$("table.table-datatable2");function loadNewsAjax(){const t=e.DataTable($.extend(!0,{},dtDefaultOptions,{order:[[2,"desc"]],createdRow:function(e,t,a){$(e).attr("data-app-id",t[6])},columnDefs:[{targets:0,render:function(e,t,a){return""===a[8]?a[8]="/assets/img/no-app-image-square.jpg":a[8].startsWith("/")||a[8].startsWith("http")||(a[8]="https://steamcdn-a.akamaihd.net/steamcommunity/public/images/apps/"+a[6]+"/"+a[8]+".jpg"),'<img src="'+a[8]+'" class="rounded square" alt="'+a[7]+'"><span>'+a[7]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img"),$(e).attr("data-link",a[9])},orderable:!1},{targets:1,render:function(e,t,a){return"<span>"+a[1]+'</span><div class="d-none">'+a[5]+"</div>"},createdCell:function(e,t,a,n,r){$(e).addClass("article-title")},orderable:!1},{targets:2,render:function(e,t,a){return'<span data-toggle="tooltip" data-placement="left" title="'+a[4]+'" data-livestamp="'+a[3]+'"></span>'},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1}]}));dataTables.push(t),e.on("click","tr[role=row] td.article-title",function(){const e=$(this).closest("tr"),a=t.row(e);a.child.isShown()?(a.child.hide(),e.removeClass("shown")):(a.child($("<div/>").html(a.data()[5]).text()).show(),e.addClass("shown"))})}$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){const t=$(e.target);$(e.relatedTarget);"#apps"===t.attr("href")&&(t.attr("loaded")||(t.attr("loaded",1),loadNewsAjax())),$.each(dataTables,function(e,t){t.fixedHeader.adjust()})}),$(".minned").on("click",function(e){$(this).toggleClass("minned")})}if($("#packages-page").length>0){const e=$.extend(!0,{},dtDefaultOptions,{order:[[4,"desc"]],createdRow:function(e,t,a){$(e).attr("data-link",t[1])},columnDefs:[{targets:0,render:function(e,t,a){return'<img src="'+a[8]+'" class="rounded square" alt="'+a[2]+'"><span>'+a[2]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")}},{targets:1,render:function(e,t,a){return a[3]},orderable:!1},{targets:2,render:function(e,t,a){return a[4].toLocaleString()}},{targets:3,render:function(e,t,a){return a[5]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")}},{targets:4,render:function(e,t,a){return'<span data-toggle="tooltip" data-placement="left" title="'+a[7]+'" data-livestamp="'+a[6]+'">'+a[7]+"</span>"},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")}}]}),t=$("table.table-datatable2"),a=t.DataTable(e);websocketListener("packages",function(n){const r=a.page.info();if(0===r.page){const a=$.parseJSON(n.data);addDataTablesRow(e,a.Data,r.length,t)}})}const $playerPage=$("#player-page");if($playerPage.length>0){function loadPlayerGames(){const e=$("#games #all-games").DataTable($.extend(!0,{},dtDefaultOptions,{order:[[2,"desc"]],createdRow:function(e,t,a){$(e).attr("data-app-id",t[0]),$(e).attr("data-link",t[7])},columnDefs:[{targets:0,render:function(e,t,a){return'<img src="'+a[2]+'" class="rounded square" alt="'+a[1]+'"><span>'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")}},{targets:1,render:function(e,t,a){return a[5]}},{targets:2,render:function(e,t,a){return a[4]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")}},{targets:3,render:function(e,t,a){return a[6]}}]}));dataTables.push(e);const t=$("#games #recent-games").DataTable($.extend(!0,{},dtDefaultOptions,{order:[[2,"desc"]],createdRow:function(e,t,a){$(e).attr("data-app-id",t[0]),$(e).attr("data-link",t[5])},columnDefs:[{targets:0,render:function(e,t,a){return'<img src="'+a[1]+'" class="rounded square" alt="'+a[2]+'"><span>'+a[2]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")}},{targets:1,render:function(e,t,a){return a[3].toLocaleString()}},{targets:2,render:function(e,t,a){return a[4].toLocaleString()},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")}}]}));dataTables.push(t)}function loadPlayerFriends(){const e=$("#friends table.table-datatable2").DataTable($.extend(!0,{},dtDefaultOptions,{order:[[2,"desc"]],createdRow:function(e,t,a){$(e).attr("data-link",t[1])},columnDefs:[{targets:0,render:function(e,t,a){return'<img src="'+a[2]+'" class="rounded square" data-src="/assets/img/no-player-image.jpg" alt="'+a[3]+'"><span>'+a[3]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,t,a){return a[4].toLocaleString()},orderSequence:["desc","asc"]},{targets:2,render:function(e,t,a){return a[5]?0===a[6]?$lockIcon:a[6].toLocaleString():"-"},orderSequence:["desc","asc"]},{targets:3,render:function(e,t,a){return a[7]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:4,render:function(e,t,a){return a[8]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderSequence:["asc","desc"]}]}));dataTables.push(e)}function loadPlayerBadges(){const e=$("#badges table.table-datatable2").DataTable($.extend(!0,{},dtDefaultOptions,{order:[[2,"desc"]],createdRow:function(e,t,a){$(e).attr("data-app-id",t[0]),$(e).attr("data-link",t[2])},columnDefs:[{targets:0,render:function(e,t,a){return'<img src="'+a[5]+'" class="rounded square" alt="'+a[1]+'"><span>'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img"),$(e).attr("nowrap","nowrap")}},{targets:1,render:function(e,t,a){return a[6].toLocaleString()+" ("+a[8].toLocaleString()+"xp)"},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")}},{targets:2,render:function(e,t,a){return a[7].toLocaleString()}},{targets:3,render:function(e,t,a){return a[3].toLocaleString()},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")}}]}));dataTables.push(e)}function loadPlayerCharts(){const e={chart:{type:"line",backgroundColor:"rgba(0,0,0,0)"},title:{text:""},subtitle:{text:""},credits:{enabled:!1},legend:{enabled:!0},plotOptions:{},xAxis:{title:{text:""},type:"datetime"}};$.ajax({type:"GET",url:"/players/"+$playerPage.attr("data-id")+"/history.json",dataType:"json",success:function(t,a,n){null===t&&(t=[]);const r={allowDecimals:!1,title:{text:""},labels:{enabled:!1}};Highcharts.chart("history-chart",$.extend(!0,{},e,{yAxis:[r,r,r,r,r],tooltip:{formatter:function(){return this.y.toLocaleString()+" "+this.series.name.toLowerCase()+" on "+moment(this.key).format("dddd DD MMM YYYY")}},series:[{name:"Level",color:"#28a745",data:t.mean_level,marker:{symbol:"circle"},yAxis:0},{name:"Games",color:"#007bff",data:t.mean_games,marker:{symbol:"circle"},yAxis:1},{name:"Badges",color:"#e83e8c",data:t.mean_badges,marker:{symbol:"circle"},yAxis:2},{name:"Playtime",color:"#ffc107",data:t.mean_playtime,marker:{symbol:"circle"},yAxis:3},{name:"Friends",color:"#343a40",data:t.mean_friends,marker:{symbol:"circle"},yAxis:4}]}));const o={allowDecimals:!1,title:{text:""},reversed:!0,min:1,labels:{enabled:!1}};Highcharts.chart("ranks-chart",$.extend(!0,{},e,{yAxis:[o,o,o,o,o],tooltip:{formatter:function(){return this.series.name+" rank "+this.y.toLocaleString()+" on "+moment(this.key).format("dddd DD MMM YYYY")}},series:[{name:"Level",color:"#28a745",data:t.mean_level_rank,marker:{symbol:"circle"},yAxis:0},{name:"Games",color:"#007bff",data:t.mean_games_rank,marker:{symbol:"circle"},yAxis:1},{name:"Badges",color:"#e83e8c",data:t.mean_badges_rank,marker:{symbol:"circle"},yAxis:2},{name:"Playtime",color:"#ffc107",data:t.mean_playtime_rank,marker:{symbol:"circle"},yAxis:3},{name:"Friends",color:"#343a40",data:t.mean_friends_rank,marker:{symbol:"circle"},yAxis:4}]}))}})}$("a[data-update-id]").on("click",function(e){e.preventDefault();const t=$(this);$("i",t).addClass("fa-spin"),$.ajax({url:"/players/"+$(this).attr("data-update-id")+"/update.json",dataType:"json",cache:!1,success:function(e,a,n){toast(e.success,e.toast),$("i",t).removeClass("fa-spin"),e.log&&console.log(e.log)}})}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){const t=$(e.target);$(e.relatedTarget);"#charts"===t.attr("href")&&(t.attr("loaded")||(t.attr("loaded",1),loadPlayerCharts())),"#games"===t.attr("href")&&(t.attr("loaded")||(t.attr("loaded",1),loadPlayerGames())),"#badges"===t.attr("href")&&(t.attr("loaded")||(t.attr("loaded",1),loadPlayerBadges())),"#friends"===t.attr("href")&&(t.attr("loaded")||(t.attr("loaded",1),loadPlayerFriends())),$.each(dataTables,function(e,t){t.fixedHeader.adjust()})}),websocketListener("profile",function(e){$.parseJSON(e.data).Data.toString()===$playerPage.attr("data-id")&&toast(!0,"Click to refresh","This player has been updated",-1,"refresh")})}if($("#queues-page").length>0||$("#player-missing-page").length>0){const e=$("#player-missing-page");websocketListener("profile",function(t){$.parseJSON(t.data).Data.toString()===e.attr("data-id")&&(toast(!0,"","Player found!"),location.reload())})}if($("#ranks-page").length>0){const e=$("table.table-datatable2");$("form").on("submit",function(t){return e.DataTable().draw(),!1}),e.DataTable($.extend(!0,{},dtDefaultOptions,{ajax:function(e,t,a){e.search={},e.search.search=$("#search").val(),dtDefaultOptions.ajax(e,t,a,$(this))},language:{zeroRecords:"No players found <a href='/players/add'>Add a Player</a>"},order:[[3,"desc"]],createdRow:function(e,t,a){$(e).attr("data-link","/players/"+t[1])},columnDefs:[{targets:0,render:function(e,t,a){return a[0]},createdCell:function(e,t,a,n,r){$(e).addClass("font-weight-bold")},orderable:!1},{targets:1,render:function(e,t,a){return'<img src="'+a[3]+'" class="rounded square" alt="'+a[2]+'"><span>'+a[2]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")},orderable:!1},{targets:2,render:function(e,t,a){return a[11]?'<img data-toggle="tooltip" data-placement="left" title="'+a[12]+'" src="'+a[11]+'" class="rounded" alt="'+a[12]+'">':""},createdCell:function(e,t,a,n,r){$(e).addClass("img")},orderable:!1},{targets:3,render:function(e,t,a){return'<div class="'+a[4]+' square"></div><span>'+a[5].toLocaleString()+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")},orderSequence:["desc"]},{targets:4,render:function(e,t,a){return a[6]?a[6].toLocaleString():$lockIcon},orderSequence:["desc"]},{targets:5,render:function(e,t,a){return a[7].toLocaleString()},orderSequence:["desc"]},{targets:6,render:function(e,t,a){return"-"===a[8]?$lockIcon:a[8]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap"),"0m"!==a[8]&&$(e).attr("data-toggle","tooltip").attr("data-placement","left").attr("title",a[9])},orderSequence:["desc"]},{targets:7,render:function(e,t,a){return 0===a[10]?$lockIcon:a[10].toLocaleString()},orderSequence:["desc"]}]}))}if($("#price-changes-page").length>0){const e=$("select.form-control-chosen"),t=$("table.table-datatable2"),a=$("form");window.location.search&&a.deserialize(window.location.search.substr(1)),e.chosen({disable_search_threshold:10,allow_single_deselect:!0,rtl:!1,max_selected_options:10});const n=$("#change-low").val(),r=$("#change-high").val(),o=$("#change-slider")[0],s=noUiSlider.create(o,{start:[parseInt(n||-100),parseInt(r||100)],connect:!0,step:1,range:{min:-100,max:100}}),i=$("#price-low").val(),l=$("#price-high").val(),c=$("#price-slider")[0],d=noUiSlider.create(c,{start:[parseInt(i||-100),parseInt(l||100)],connect:!0,step:1,range:{min:0,max:100}});function onPercentChange(e){const t=s.get();$("#change-low").val(t[0]),$("#change-high").val(t[1]),redrawTable()}function onPriceChange(e){const t=d.get();$("#price-low").val(t[0]),$("#price-high").val(t[1]),redrawTable()}function redrawTable(e){let n=a.serializeArray();return n=$.grep(n,function(e){return""!==e.value}),t.DataTable().draw(),history.pushState({},document.title,"/price-changes?"+$.param(n)),updateLabels(e),!1}function updateLabels(e){const t=s.get(),a=d.get();t[0]===t[1]?$("label#change-label").html("Price Change Percent ("+Math.round(t[0])+"%)"):$("label#change-label").html("Price Change Percent ("+Math.round(t[0])+"% - "+Math.round(t[1])+"%)"),a[0]===a[1]?$("label#price-label").html("Final Price ("+user.userCurrencySymbol+Math.round(a[0])+")"):$("label#price-label").html("Final Price ("+user.userCurrencySymbol+Math.round(a[0])+" - "+user.userCurrencySymbol+Math.round(a[1])+")")}e.on("change",redrawTable),a.on("submit",redrawTable),s.on("set",onPercentChange),s.on("update",updateLabels),d.on("set",onPriceChange),d.on("update",updateLabels),$(document).ready(updateLabels);const u=$.extend(!0,{},dtDefaultOptions,{order:[[4,"desc"]],ajax:function(e,t,a){e.search.type=$("#type").val(),e.search.percents=s.get(),e.search.prices=d.get(),dtDefaultOptions.ajax(e,t,a,$(this))},createdRow:function(e,t,a){let n;$(e).attr("data-app-id",t[0]),$(e).attr("data-link",t[5]),t[9]?(n=Math.min(t[9],100),n+=100,n/=2):n=100,$(e).addClass("col-grad-"+Math.round(n))},columnDefs:[{targets:0,render:function(e,t,a){return'<img src="'+a[4]+'" class="rounded square" alt="'+a[3]+'"><span>'+a[3]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,t,a){return a[6]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,t,a){return a[7]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(e,t,a){const n="<small>"+a[9]+"%</small>";return 0===a[9]?a[8]+" <small>∞%</small> ":a[8]+" "+n},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:4,render:function(e,t,a){return'<span data-toggle="tooltip" data-placement="left" title="'+a[10]+'" data-livestamp="'+a[11]+'">'+a[10]+"</span>"},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1}]}),p=t.DataTable(u);websocketListener("prices",function(e){const a=p.page.info();if(0===a.page){const n=$.parseJSON(e.data);addDataTablesRow(u,n.Data,a.length,t)}})}if($("#product-keys-page").length>0){$("table.table-datatable2").DataTable($.extend(!0,{},dtDefaultOptions,{ajax:function(e,t,a){e.search.key=$("#key").val(),e.search.value=$("#value").val(),e.search.type=$("input[name=type]:checked").val(),dtDefaultOptions.ajax(e,t,a,$(this))},order:[[0,"asc"]],createdRow:function(e,t,a){$(e).attr("data-app-id",t[0]),$(e).attr("data-link",t[3])},columnDefs:[{targets:0,render:function(e,t,a){return'<img src="'+a[2]+'" class="rounded square" alt="'+a[1]+'"><span>'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")}},{targets:1,render:function(e,t,a){return a[4]},orderable:!1}]}))}if($("#queues-page").length>0||$("#player-missing-page").length>0){let e=!0;$(window).on("focus",function(){e=!0}),$(window).on("blur",function(){e=!1});const t={};$("[data-queue]").each(function(e,a){t[$(this).attr("data-queue")]=loadChart($(this).find("div").attr("id"))}),updateCharts();const a=window.setInterval(updateCharts,1e4);function updateCharts(){e&&$.ajax({url:"/queues/queues.json",dataType:"json",cache:!1,success:function(e,a,n){$.each(t,function(t,a){a.series[0].setData(e[t].sum_messages)})},error:function(e,t,n){clearTimeout(a),$("#live-badge").addClass("badge-danger").removeClass("badge-secondary badge-success"),toast(!1,"Live functionality has stopped")}})}function loadChart(e){return Highcharts.chart(e,{chart:{animation:!1,backgroundColor:"rgba(0,0,0,0)"},title:{text:""},subtitle:{text:""},credits:{enabled:!1},legend:{enabled:!1},xAxis:{title:{text:""},labels:{step:1,formatter:function(){return moment(this.value).format("h:mm")}},type:"datetime"},yAxis:[{title:{text:""},allowDecimals:!1,min:0}],plotOptions:{series:{marker:{enabled:!1},animation:!1}},series:[{color:"#28a745",yAxis:0,name:"size",type:"areaspline"}],tooltip:{formatter:function(){return this.y.toLocaleString()+" items in the queue at "+moment(this.key).format("h:mm")+" UTC"}}})}}function recaptchaCallback(e){$("form[data-recaptcha] button[type=submit]").prop("disabled",!1);const t=$("form[data-recaptcha] input[type=text], form input[type=email], form textarea").filter(function(){return""===$(this).val()});t.length>0&&t.get(0).focus()}if($("#settings-page").length>0){function loadEvents(){const e=$("#events table.table-datatable2").DataTable($.extend(!0,{},dtDefaultOptions,{order:[[0,"desc"]],columnDefs:[{targets:0,render:function(e,t,a){return'<span data-toggle="tooltip" data-placement="left" title="'+a[1]+'" data-livestamp="'+a[0]+'">'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,t,a){return'<i class="fas '+a[7]+'"></i> '+a[2]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,t,a){return a[3]===a[6]?'<span class="font-weight-bold" data-toggle="tooltip" data-placement="left" title="Your current IP">'+a[3]+"</span>":a[3]},orderable:!1},{targets:3,render:function(e,t,a){return'<span data-toggle="tooltip" data-placement="left" title="'+a[4]+'">'+a[5]+"</span>"},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1}]}));dataTables.push(e)}function loadDonations(){const e=$("#donations table.table-datatable2").DataTable($.extend(!0,{},dtDefaultOptions,{order:[[0,"desc"]],columnDefs:[{targets:0,render:function(e,t,a){return'<span data-toggle="tooltip" data-placement="left" title="'+a[1]+'" data-livestamp="'+a[0]+'">'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,t,a){return'<i class="fas '+a[7]+'"></i> '+a[2]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1}]}));dataTables.push(e)}$("input:password").pwstrength({ui:{showPopover:!1,showErrors:!1},common:{usernameField:"#email"}}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){const t=$(e.target);$(e.relatedTarget);"#events"===t.attr("href")&&(t.attr("loaded")||(t.attr("loaded",1),loadEvents())),"#donations"===t.attr("href")&&(t.attr("loaded")||(t.attr("loaded",1),loadDonations())),$.each(dataTables,function(e,t){t.fixedHeader.adjust()})})}if($("#stats-page").length>0){const e={chart:{type:"column",backgroundColor:"rgba(0,0,0,0)"},title:{text:""},subtitle:{text:""},credits:{enabled:!1},legend:{enabled:!1},xAxis:{title:{text:""},type:"category"},yAxis:{allowDecimals:!1,title:{text:""}},series:[{color:"#28a745"}],plotOptions:{series:{pointPadding:0,groupPadding:0}}};$.ajax({type:"GET",url:"/stats/client-players.json",dataType:"json",success:function(t,a,n){null===t&&(t=[]),Highcharts.chart("client-players",$.extend(!0,{},e,{chart:{type:"area"},xAxis:{type:"datetime"},tooltip:{formatter:function(){const e=moment(this.key).format("dddd DD MMM YYYY @ HH:mm");return"ingame"===this.series.name?this.y.toLocaleString()+" people in a game on "+e:this.y.toLocaleString()+" people online on "+e}},plotOptions:{series:{cursor:"pointer",point:{events:{click:function(){window.location.href="/apps?score-low="+this.x+"&score-high="+(this.x+1)}}}}},series:[{name:"ingame",marker:{symbol:"circle"},data:t.max_player_count},{name:"online",marker:{symbol:"circle"},color:"#007bff",data:t.max_player_online,type:"line"}]}))}}),$.ajax({type:"GET",url:"/stats/app-scores.json",dataType:"json",success:function(t,a,n){null===t&&(t=[]),Highcharts.chart("scores",$.extend(!0,{},e,{xAxis:{tickInterval:5},tooltip:{formatter:function(){return this.y.toLocaleString()+" apps have "+this.x+"/100"}},plotOptions:{series:{cursor:"pointer",point:{events:{click:function(){window.location.href="/apps?score-low="+this.x+"&score-high="+(this.x+1)}}}}},series:[{data:t}]}))}}),$.ajax({type:"GET",url:"/stats/app-types.json",dataType:"json",success:function(t,a,n){null===t&&(t=[]),Highcharts.chart("types",$.extend(!0,{},e,{xAxis:{labels:{rotation:-20}},tooltip:{formatter:function(){return this.y.toLocaleString()+" "+this.key+" apps"}},plotOptions:{series:{cursor:"pointer",point:{events:{click:function(){let e=this.name.toLowerCase();"unknown"===e&&(e=""),window.location.href="/apps?types="+e}}}}},series:[{data:t,dataLabels:{enabled:!0,formatter:function(){return this.y.toLocaleString()}}}]}))}}),$.ajax({type:"GET",url:"/stats/release-dates.json",dataType:"json",success:function(t,a,n){null===t&&(t=[]),Highcharts.chart("release-dates",$.extend(!0,{},e,{chart:{type:"area"},xAxis:{type:"datetime"},tooltip:{formatter:function(){return this.y.toLocaleString()+" apps released on "+moment(this.key).format("dddd DD MMM YYYY")}},series:[{data:t}],plotOptions:{area:{lineWidth:1,states:{hover:{lineWidth:1}}}}}))}})}const $steamApiPage=$("#steam-api-page");if($steamApiPage.length>0){$("#sidebar").stickySidebar({topSpacing:0,bottomSpacing:16}),$(".endpoint").on("mouseenter",function(){$(this).select()});const e=$steamApiPage.find("form#key-form");function setMethodSettings(){const e=$("#key-form input[name=key]").val(),t=$("#key-form select[name=format]").val();$("div.interface input[name=key]").val(e),$("div.interface input[name=format]").val(t)}e.on("submit",function(t){t.preventDefault(),localStorage.setItem("settings",e.serialize()),setMethodSettings(),toast(!0,"Settings Saved")}),e.deserialize(localStorage.getItem("settings")),setMethodSettings()}if($("#upcoming-page").length>0){const e=$("table.table-datatable2").DataTable($.extend(!0,{},dtDefaultOptions,{order:[],pageLength:100,ajax:function(e,t,a){e.search.search=$("#search").val(),dtDefaultOptions.ajax(e,t,a,$(this))},createdRow:function(e,t,a){$(e).attr("data-app-id",t[0]),$(e).attr("data-link",t[3])},drawCallback:function(e){const t=this.api(),a=t.rows({page:"current"}).nodes();let n=null;t.rows().every(function(e,t,r){let o=this.data()[6];n!==o&&($(a).eq(e).before('<tr class="table-success"><td colspan="3">'+o+"</td></tr>"),n=o)})},columnDefs:[{targets:0,render:function(e,t,a){return'<img src="'+a[2]+'" class="rounded square" alt="'+a[1]+'"><span>'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,t,a){return a[4]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,t,a){return a[5]},createdCell:function(e,t,a,n,r){$(e).attr("nowrap","nowrap")},orderable:!1}]}));$("form").on("submit",function(t){t.preventDefault(),e.search($("#search").val()).draw()})}const $wishlistsPage=$("#wishlists-page");$wishlistsPage.length>0&&($("#apps table.table-datatable2").DataTable($.extend(!0,{},dtDefaultOptions,{order:[[1,"desc"]],createdRow:function(e,t,a){$(e).attr("data-app-id",t[0]),$(e).attr("data-link",t[2])},columnDefs:[{targets:0,render:function(e,t,a){return'<img src="'+a[4]+'" class="rounded square" alt="'+a[1]+'"><span>'+a[1]+"</span>"},createdCell:function(e,t,a,n,r){$(e).addClass("img")}},{targets:1,render:function(e,t,a){return a[3].toLocaleString()}}]})),$("#tags table.table-datatable2").DataTable($.extend(!0,{},dtDefaultOptions,{pageLength:1e3,order:[[1,"desc"]],createdRow:function(e,t,a){$(e).attr("data-link",t[2])},columnDefs:[{targets:0,render:function(e,t,a){return'<i class="fas fa-tag"></i> '+a[1]}},{targets:1,render:function(e,t,a){return a[3].toLocaleString()}}]})));
//# sourceMappingURL=main.js.map