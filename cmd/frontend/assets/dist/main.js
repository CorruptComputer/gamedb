function isMobile(){const e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series([46])0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br([ev])w|bumb|bw-([nu])|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do([cp])o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly([-_])|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-([mpt])|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c([- _agpst])|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac([ \-\/])|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja([tv])a|jbro|jemu|jigs|kddi|keji|kgt([ \/])|klon|kpt |kwc-|kyo([ck])|le(no|xi)|lg( g|\/([klu])|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t([- ov])|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30([02])|n50([025])|n7(0([01])|10)|ne(([cm])-|on|tf|wf|wg|wt)|nok([6i])|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan([adt])|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c([-01])|47|mc|nd|ri)|sgh-|shar|sie([-m])|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel([im])|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c([- ])|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.substr(0,4))}!function(e){"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){function a(e,a,t){var r=t[e];return void 0===r?t[e]=[a]:r.push(a),t}var t={checked:["radio","checkbox"],selected:["option","select-one","select-multiple"],value:["button","color","date","datetime","datetime-local","email","hidden","month","number","password","range","reset","search","submit","tel","text","textarea","time","url","week"]};function r(a,r,n,s,o){var l=function(a){var r=function(e){return(e.type||e.nodeName).toLowerCase()}(a),n=void 0;return e.each(t,function(a,t){if(e.inArray(r,t)>-1)return n=a,!1}),n}(a);if("value"==l&&r==s)a.value=n,o.call(a,n);else if("checked"==l||"selected"==l){var i=[];a.options?e.each(a.options,function(e,a){i.push(a)}):i.push(a),a.multiple&&0==s&&(a.selectedIndex=-1),e.each(i,function(e,a){a.value==n&&(a[l]=!0,o.call(a,n))})}}var n={change:e.noop,complete:e.noop};e.fn.deserialize=function(t,s){e.isFunction(s)&&(s={complete:s}),s=e.extend(n,s||{}),t=function(t){var r={},n=/\+/g;return e.isPlainObject(t)?(e.extend(r,t),e.each(r,function(a,t){e.isArray(t)||(r[a]=[t])})):e.isArray(t)?e.each(t,function(e,t){a(t.name,t.value,r)}):"string"==typeof t&&e.each(t.split("&"),function(e,t){var s=t.split("=");a(decodeURIComponent(s[0].replace(n,"%20")),decodeURIComponent(s[1].replace(n,"%20")),r)}),r}(t);var o=function(t,r){var n={},s=t.map(function(){return this.elements?e.makeArray(this.elements):this}).filter(r||":input:not(:disabled)").get();return e.each(s,function(e,t){a(t.name,t,n)}),n}(this,s.filter);return e.each(t,function(a,t){e.each(o[a],function(a,n){e.each(t,function(e,t){r(n,a,t,e,s.change)})})}),s.complete.call(this),this}});const defaultChartOptions={chart:{type:"spline",backgroundColor:"rgba(0,0,0,0)",spacing:[4,0,0,0]},title:{text:""},subtitle:{text:""},credits:{enabled:!1},xAxis:{title:{text:""},type:"datetime"},legend:{enabled:!0,itemStyle:{color:"#28a745"},itemHiddenStyle:{color:"#666666"}},plotOptions:{series:{marker:{enabled:!1}}},colors:["#28a745","#7cb5ec","#f15c80","#f7a35c","#8085e9","#434348","#e4d354","#2b908f","#f45b5b","#91e8e1"]};function highLightOwnedGames(e){if(e||(e=$("body")),user.isLoggedIn){let a=localStorage.getItem("gamedb-games");null!=a&&null!=(a=JSON.parse(a))&&e.find("[data-app-id]").each(function(){const e=$(this).attr("data-app-id");-1!==a.indexOf(parseInt(e))&&$(this).addClass("font-weight-bold")});let t=localStorage.getItem("gamedb-groups");null!=t&&null!=(t=JSON.parse(t))&&e.find("[data-group-id]").each(function(){const e=$(this).attr("data-group-id");-1!==t.indexOf(e)&&$(this).addClass("font-weight-bold")});let r=localStorage.getItem("gamedb-badges");null!=r&&null!=(r=JSON.parse(r))&&e.find("[data-badge-id]").each(function(){const e=$(this).attr("data-badge-id");-1!==r.indexOf(parseInt(e))&&$(this).addClass("font-weight-bold")})}}function isIterable(e){return null!=e&&"function"==typeof e[Symbol.iterator]}function isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}function isJson(e){try{JSON.parse(e)}catch(e){return!1}return!0}function logLocal(){user.log&&console.log(...arguments)}function setUrlParam(e,a){const t=new URL(window.location);if(Array.isArray(a)){t.searchParams.delete(e);for(const r of a)t.searchParams.append(e,r)}else t.searchParams.set(e,a);t.searchParams.sort(),window.history.replaceState(null,null,t.pathname+t.search+t.hash)}function deleteUrlParam(e){const a=new URL(window.location);a.searchParams.delete(e),window.history.replaceState(null,null,a.pathname+a.search+a.hash)}function clearUrlParams(){window.history.replaceState(null,null,window.location.pathname+window.location.hash)}function ordinal(e){let a=e%10,t=e%100;return 1===a&&11!==t?e.toLocaleString()+"st":2===a&&12!==t?e.toLocaleString()+"nd":3===a&&13!==t?e.toLocaleString()+"rd":e.toLocaleString()+"th"}function pad(e,a,t){return t=t||"0",(e+="").length>=a?e:new Array(a-e.length+1).join(t)+e}function pauseAllVideos(){$("video").each(function(e){$(this)[0].pause()})}function handleVideos(){$("#media video").on("click",function(e){const a=$(this)[0];a.paused?(pauseAllVideos(),a.play()):a.pause()})}function observeLazyImages(e){if(!e)return;"string"!=typeof e&&"object"!=typeof e||(e=$(e));let a=new IntersectionObserver(function(e,a){e.forEach(e=>{e.isIntersecting&&(loadImage($(e.target)),a.unobserve(e.target))})},{rootMargin:"0px 0px 50px 0px",threshold:0});e.each(function(e){a.observe(this)})}function observeLazyVideos(){let e=new IntersectionObserver(function(e,a){e.forEach(e=>{e.isIntersecting&&(loadVideo($(e.target)),a.unobserve(e.target))})},{rootMargin:"0px 0px 50px 0px",threshold:0});$("video").each(function(a){e.observe(this)})}function loadVideo(e){e.attr("preload","metadata")}function loadImage(e){const a=e.attr("data-lazy-alt");a&&e.attr("alt",a);const t=e.attr("data-lazy-title");t&&e.attr("title",t);const r=e.attr("data-lazy");r&&e.attr("src",r),e.removeAttr("data-lazy-alt"),e.removeAttr("data-lazy-title"),e.removeAttr("data-lazy"),e.attr("data-observed",1)}function fixBrokenImages(){$("img").one("error",function(){const e=$(this).attr("data-src");this.src=e||"/assets/img/no-app-image-square.jpg"}),$('img[src=""][data-src]').each(function(e,a){this.src=$(this).attr("data-src")})}function _numbers(e,a){let t;const r=Math.floor(4.5);return a<=9?t=_range(0,a):e<=r?(t=_range(0,7)).push("ellipsis"):e>=a-1-r?((t=_range(a-7,a)).splice(0,0,"ellipsis"),t.splice(0,0,0)):((t=_range(e-r+2,e+r-1)).push("ellipsis"),t.splice(0,0,"ellipsis"),t.splice(0,0,0)),t.DT_el="span",t}function _range(e,a){const t=[];let r;r=a;for(let n=a=e;n<r;n++)t.push(n);return t}function toast(e,a,t="",r=0,n=""){0===r?r=5:r<0&&(r=0);const s={onclick:n?function(){"refresh"===n&&location.reload()}:null,newestOnTop:!1,preventDuplicates:!1,progressBar:!0,timeOut:1e3*r,extendedTimeOut:1e3*r};return isMobile()?(s.positionClass="toast-bottom-right",s.newestOnTop=!0):s.positionClass="toast-top-right",e?toastr.success(a,t,s):toastr.error(a,t,s)}let _websocket;function websocketListener(e,a,t=1){if(void 0===window.WebSocket)return void(user.log&&log.console("Your browser does not support websockets"));if(_websocket&&_websocket.readyState===WebSocket.OPEN)return void logLocal("Websocket already open");_websocket=new WebSocket(("https:"===location.protocol?"wss://gamedb.online":"ws://"+location.host)+"/websocket/"+e);let r=$("#live-badge");_websocket.onopen=function(e){logLocal("websocket opened"),r.addClass("badge-success cursor-pointer"),r.removeClass("badge-secondary badge-danger"),t=1},_websocket.onclose=function(e){logLocal("Websocket closed",e),n(r,t,e,"onclose")},_websocket.onerror=function(e){logLocal("Websocket error",e),n(r,t,e,"onerror")},_websocket.onmessage=function(e){return logLocal("WS: "+e.data),a(e)},1===t&&r.on("click",function(t){$(this).hasClass("badge-danger")?(logLocal("Websocket opened manually"),websocketListener(e,a,2),r.addClass("badge-success"),r.removeClass("badge-secondary badge-danger")):$(this).hasClass("badge-success")&&(logLocal("Websocket closed manually",t),null!==_websocket&&_websocket.close(1e3),t.code=1e3,n(r,1,t,"manual"))});const n=function(t,r,n,s){logLocal(s,r),_websocket=null,t.addClass("badge-danger"),t.removeClass("badge-secondary badge-success"),"onclose"!==s&&"manual"!==s||1e3!==n.code&&setTimeout(function(){websocketListener(e,a,r+1)},5e3)}}$(fixBrokenImages),$(handleVideos),$(observeLazyImages("img[data-lazy]")),$(observeLazyVideos()),$.fn.dataTableExt.oPagination.gamedb=function(e,a){return["previous",_numbers(e,a),"next"]},function(e,a,t,r,n){"use strict";const s={cache:!0,searchFields:[],tableOptions:{autoWidth:!1,dom:'<"dt-header"<"dt-pagination"p><"dt-info"i>>t<"dt-footer"<"dt-pagination"p>>r',fixedHeader:!0,info:!0,processing:!1,language:{processing:'<i class="fas fa-spinner fa-spin fa-3x fa-fw"></i>',paginate:{next:'<i class="fas fa-chevron-right"></i>',previous:'<i class="fas fa-chevron-left"></i>'},info:"_TOTAL_ rows (_PAGES_ pages)",infoFiltered:" of _MAX_"},lengthChange:!1,ordering:!0,pageLength:100,paging:!0,pagingType:"gamedb",searching:!0,stateSave:!1,search:{smart:!0}}};function o(t,o){const u=e(t);o=e.extend(!0,{},s,o),u.hasClass("table-counts")||(o.tableOptions.dom=o.tableOptions.dom.replace('<"dt-info"i>',"")),o.isAjax=function(){return null!=u.attr("data-path")};const p=u.attr("data-row-type");p&&(o.tableOptions.language.info="_TOTAL_ "+p+" (_PAGES_ pages)");let m={},g={};if(o.isAjax())o=e.extend(!0,{},o,{tableOptions:{processing:!1,serverSide:!1!==o.tableOptions.serverSide,orderMulti:!1,ajax:function(a,t,r){delete a.columns,a.search=g,e.ajax({data:a,dataType:"json",cache:o.cache,url:u.attr("data-path"),success:t,error:function(e,r,n){t(a={draw:"1",recordsTotal:"0",recordsFiltered:"0",data:[],limited:!1},r,null)}})}}});else{const a=u.find("thead tr th[data-disabled]").map(function(){return e(this).index()}).get();o=e.extend(!0,{},o,{tableOptions:{columnDefs:[{orderable:!1,targets:a}]}});const t=u.attr("data-limit");t&&(o.tableOptions.pageLength=parseInt(t))}for(const e of o.searchFields){const a=c(e),t=l(e);a===n&&logLocal("Search field missing name field"),a&&t&&t.length>0&&(m[a]=t,g[a]=t)}const f=new URL(a.location).searchParams;for(const e of o.searchFields){const a=c(e);if(a&&f.has(a)){let t;i(e,t=d(e)?f.getAll(a):f.get(a)),g[a]=t,e.attr("data-hightlight")&&(this.highlight=t);const r=e.attr("data-col-sort");r&&t&&(o.tableOptions.order=[[parseInt(r),"desc"]])}}this.options=o,this.element=t,this.user=r,this.initialValues=m,this.currentValues=g,this.urlParams=f,this.init()}function l(e){return e.hasClass("noUi-target")?e[0].noUiSlider.get():"radio"===e.attr("type")?e.filter(":checked").val():e.val()}function i(e,a){e.hasClass("noUi-target")?e[0].noUiSlider.set(a):"radio"===e.attr("type")?e.filter("[value"+a+"]").prop("checked",!0):(e.val(a),e.hasClass("form-control-chosen")&&e.trigger("chosen:updated"))}function c(e){return e.hasClass("noUi-target")?e.attr("data-name"):e.attr("name")}function d(e){return e.hasClass("noUi-target")?l(e).length>1:!!e.prop("multiple")}e.extend(o.prototype,{init:function(){const t=this;e(this.element).on("preXhr.dt",function(a,r,n){e(t.element).stop(!0,!0).fadeTo(200,.3)}),e(this.element).on("xhr.dt",function(a,r,n,s){e(t.element).stop(!0,!0).fadeTo(200,1),t.limited=n.limited});const r=e(this.element).DataTable(this.options.tableOptions);if(this.dt=r,this.initialValues.s=e.extend(!0,[],r.order()),e(this.element).on("draw.dt",function(a,n){if(t.limited){const a=e("li.paginate_button.page-item.next.disabled").length>0?"font-weight-bold":"",r=2===t.limited?e('<li class="donate"><small><a href="/login"><i class="fas fa-unlock"></i> <span class="'+a+'">Login for more!</span></a></small></li>'):e('<li class="donate"><small><a href="/donate"><i class="fas fa-heart text-danger"></i> <span class="'+a+'">Donate for more!</span></a></small></li>');e(t.element).parent().find(".dt-pagination ul.pagination").append(r)}const s=e(t.element).parent().find(".dt-header .dt-pagination"),o=e(t.element).parent().find(".dt-footer .dt-pagination");if(r.page.info().pages<=1?(o.hide(),e(t.element).hasClass("table-counts")||s.hide()):(o.show(),s.show()),e.fn.mark){const a=e(".markable");a.unmark(),t.highlight&&a.mark(t.highlight)}highLightOwnedGames(e(t.element)),observeLazyImages(e(t.element).find("img[data-lazy]")),fixBrokenImages()}),e(this.element).on("page.dt",function(a,t,r){let n=15;e(".fixedHeader-floating").length>0&&(n+=48),e("html, body").animate({scrollTop:e(this).prev().offset().top-n},200)}),e('a[data-toggle="tab"]').on("shown.bs.tab",function(t){e.each(a.gdbTables,function(a,t){e(t).DataTable().fixedHeader.adjust()}),clearUrlParams()}),this.options.isAjax())for(const e of this.options.searchFields)if(e.hasClass("noUi-target")){const n=e.attr("data-name"),s=e[0].noUiSlider;s.on("set",function(e){const o=s.get();n&&(t.currentValues[n]=o,setUrlParam(n,o)),"function"==typeof a.updateLabels&&a.updateLabels(),r.draw()}),s.on("update",function(e){"function"==typeof a.updateLabels&&a.updateLabels()})}else{const a=e.attr("name");e.on("change search",function(n){let s=l(e);const o=e.attr("data-col-sort");return o&&(s?(r.order()[0][0]!==parseInt(o)&&(t.sortBeforeSearch=r.order()),r.order([parseInt(o),"desc"])):r.order(t.sortBeforeSearch)),e.attr("data-hightlight")&&(t.highlight=s),a&&(t.currentValues[a]=s,setUrlParam(a,s)),r.draw(),!1})}else for(const a of this.options.searchFields){const n=a.attr("name");a.on("keyup search",function(s){let o=l(a);const i=a.attr("data-col-sort");i&&(o?(r.order()[0][0]!==parseInt(i)&&(t.sortBeforeSearch=r.order()),r.order([parseInt(i),"desc"])):r.order(t.sortBeforeSearch)),a.attr("data-hightlight")&&(t.highlight=o),n&&(t.currentValues[n]=o,setUrlParam(n,o)),r.search(e(this).val()),r.draw()})}e("div.dt-pagination").on("focus",".paginate_button > a",function(){e(this).trigger("blur")}),this.options.isAjax()||e(t.element).trigger("draw.dt"),a.gdbTables=a.gdbTables||[],a.gdbTables.push(this.element)}}),e.fn.gdbTable=function(e){return new o(this,e).dt},e("table.table.table-datatable").each(function(a){e(this).gdbTable()})}(jQuery,window,document,user);const $document=$(document),$body=$("body");$(document).on("mouseup","[data-link] a, [data-link] .select-checkbox, [data-link-tab] a",function(e){return e.stopPropagation(),!1}),$(".stop-prop").on("click",function(e){e.stopPropagation()});let dataLinkDrag=!1,dataLinkX=0,dataLinkY=0;if($document.on("mousedown","[data-link]",function(e){dataLinkX=e.screenX,dataLinkY=e.screenY,dataLinkDrag=!1}),$document.on("mousemove","[data-link]",function(e){!dataLinkDrag&&(Math.abs(dataLinkX-e.screenX)>5||Math.abs(dataLinkY-e.screenY)>5)&&(dataLinkDrag=!0)}),$(document).on("mouseup","[data-link]",function(e){e.stopPropagation();const a=$(this).attr("data-link"),t=$(this).attr("data-target");return!a||(!!dataLinkDrag||(3===e.which||(e.ctrlKey||e.shiftKey||e.metaKey||2===e.which||"_blank"===t?($(e.target).is("a")||window.open(a,"_blank"),!0):(window.location.href=a,!0))))}),user.isProd){const e="\n _____                       ____________ \n|  __ \\                      |  _  \\ ___ \\\n| |  \\/ __ _ _ __ ___   ___  | | | | |_/ /\n| | __ / _` | '_ ` _ \\ / _ \\ | | | | ___ \\\n| |_\\ \\ (_| | | | | | |  __/ | |/ /| |_/ /\n \\____/\\__,_|_| |_| |_|\\___| |___/ \\____/ \n";console.log(e)}const $dropdowns=$(".navbar .dropdown");$dropdowns.on("mouseenter",function(e){$(this).addClass("show").find(".dropdown-menu").addClass("show")}),$dropdowns.on("mouseleave",function(e){$(this).removeClass("show").find(".dropdown-menu").removeClass("show")}),$dropdowns.on("click",function(e){e.stopPropagation()}),$body.tooltip({selector:'[data-toggle="tooltip"]'}),$(".json").each(function(e,a){const t=$(this).text();if(isJson(t)){const e=JSON.parse(t);$(this).text(JSON.stringify(e,null,"  "))}}),function(e,a){"use strict";e(function(t){const r=a.location.hash;if(r){let a="";r.split(/[,\-]/).map(function(t){e('.nav-link[href="'+(a=""===a?t:a+"-"+t)+'"]').tab("show")})}e('a[data-toggle="tab"]').on("shown.bs.tab",function(a){const t=e(a.target).attr("href");history.pushState?history.pushState(null,null,t):location.hash=t})})}(jQuery,window);const $top=$("#top");if($(window).on("scroll",function(e){$(window).scrollTop()>=1e3?$top.addClass("show"):$top.removeClass("show")}),$top.on("click",function(e){$("html, body").animate({scrollTop:0},500)}),isIterable(user.toasts))for(const e of user.toasts)toast(e.success,e.message,e.title,e.timeout,e.link);$(function(e){const a=$("#app-page, #package-page, #player-page, #bundle-page, #group-page, #badge-page, #stat-page").attr("data-path");a&&a!==window.location.pathname&&history.replaceState(null,null,a+window.location.hash)});const $lockIcon='<i class="fa fa-lock text-muted" data-toggle="tooltip" data-placement="left" title="Private"></i>';function addDataTablesRow(e,a,t,r){let n=$('<tr class="fade-green" />');if("function"==typeof e.createdRow&&e.createdRow(n[0],a,null),isIterable(e.columnDefs))for(const t of e.columnDefs){let e=a[t];"render"in t&&(e=t.render(null,null,a));const r=$("<td />").html(e);"createdCell"in t&&t.createdCell(r,null,a,null,null),r.find("[data-livestamp]").html("a few seconds ago"),n.append(r)}r.prepend(n),r.find("tbody tr").slice(t).remove(),observeLazyImages(n.find("img[data-lazy]"))}function loadAjaxOnObserve(e){for(const a in e)if(e.hasOwnProperty(a)){const t=e[a],r=document.getElementById(a);if(r){new IntersectionObserver(function(e,a){e.forEach(e=>{e.isIntersecting&&(a.unobserve(e.target),t())})},{rootMargin:"50px 0px 50px 0px",threshold:0}).observe(r)}}}const cookieName="gamedb-session-2";function setCookieFlag(e,a){let t=getSessionCookie();return t[e]=a,Cookies.set(cookieName,JSON.stringify(t),{expires:30,secure:user.isProd})}function getSessionCookie(e=null){let a=Cookies.get(cookieName),t={};return a&&(t=JSON.parse(a)),e?t[e]:t}$(".jumbotron button.close").on("click",function(e){$(this).closest(".jumbotron").slideUp(),setCookieFlag($(this).attr("data-id"),!0)});const $darkMode=$("#dark-mode");$darkMode.on("click",function(e){const a=$darkMode.find(".fa-sun"),t=$darkMode.find(".fa-moon");return a.hasClass("d-none")?(a.removeClass("d-none"),t.addClass("d-none"),$("body").removeClass("dark"),setCookieFlag("dark",!1)):(a.addClass("d-none"),t.removeClass("d-none"),$("body").addClass("dark"),setCookieFlag("dark",!0)),!1});let darkMode=getSessionCookie("dark");function getOS(){let e="windows";return-1!==navigator.appVersion.indexOf("Mac")&&(e="macos"),-1!==navigator.appVersion.indexOf("Linux")&&(e="linux"),e}void 0===darkMode&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&$darkMode.trigger("click"),$("[data-link-tab]").on("mouseup",function(){const e=$(this).attr("data-link-tab");return $('a.nav-link[href="#'+e+'"]').tab("show"),!1});const $priceChart=$("#app-page #prices-chart, #package-page #prices-chart");if($priceChart.length>0&&prices){let e,a;function upateChart(t){a&&a.abort(),$("tr[data-code]").removeClass("font-weight-bold").attr("data-link",""),$("tr[data-code="+t+"]").addClass("font-weight-bold").removeAttr("data-link"),e.showLoading(),a=$.ajax({type:"GET",data:{code:t},url:$priceChart.attr("data-ajax"),dataType:"json",cache:!0,success:function(a,t,r){"prices"in a&&(e.series[0].setData(a.prices),e.yAxis[0].update({title:{text:"Price ("+a.symbol+")"}}),e.hideLoading())}})}function loadPriceChart(){e=Highcharts.chart("prices-chart",$.extend(!0,{},defaultChartOptions,{legend:{enabled:!1},xAxis:{labels:{step:1,formatter:function(){return moment(this.value).format("Do MMM YY")}}},yAxis:{title:{text:"Price ("+user.userCurrencySymbol+")"},min:0,allowDecimals:!0},series:[{type:"line",name:"Price",step:"left",color:"#28a745"}]})),upateChart(user.prodCC)}$("#prices tr[data-code]").on("click",function(e){$(this).hasClass("font-weight-bold")||upateChart($(this).attr("data-code"))})}const $achievementsPage=$("#achievements-page");if($achievementsPage.length>0){const e={order:[[1,"asc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[7])},columnDefs:[{targets:0,render:function(e,a,t){t[8]&&(t[2]="<em>&lt;Hidden&gt;</em> "+t[2]);let r=t[5]+": "+t[9]+"<br><small>"+t[2]+"</small>";return'<a href="'+t[7]+'" class="icon-name"><div class="icon"><img class="tall" data-lazy="'+t[1]+'" alt="" data-lazy-alt="'+t[0]+'"></div><div class="name">'+r+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[3]+"%"},createdCell:function(e,a,t,r,n){t[3]=Math.ceil(t[3]),$(e).css("background","linear-gradient(to right, rgba(0,0,0,.15) "+t[3]+"%, transparent "+t[3]+"%)"),$(e).addClass("thin")},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[6]},orderable:!1,visible:!1}]},a=[$("#search")];$("table.table").gdbTable({tableOptions:e,searchFields:a})}if($("#admin-websockets-page").length>0&&setTimeout(function(){window.location.reload(1)},5e3),$("#admin-tasks-page").length>0&&($("#actions tbody tr").on("click",function(){return confirm("Are you sure?")&&$.ajax({type:"get",url:$(this).attr("data-action"),error:function(e,a,t){toast(!1,t)}}),!1}),websocketListener("admin",function(e){const a=JSON.parse(e.data),t=a.Data.task_id,r=a.Data.action;if(t&&r){const e=$('tr[data-id="'+t+'"]');"started"===r?(e.addClass("table-warning"),e.removeClass("table-danger")):"finished"===r&&(e.removeClass("table-warning"),e.removeClass("table-danger"),e.find(".prev").livestamp(),e.find(".next").livestamp(new Date(1e3*a.Data.time)),toast(!0,t+" finished","",0))}})),$("#admin-queues-page").length>0){const e=$("form#queues");e.on("submit",function(a){a.preventDefault(),$.ajax({type:"post",url:e.attr("action"),data:$(this).serialize(),success:function(a,t,r){toast(!0,"Queued"),e.trigger("reset")},error:function(e,a,t){toast(!1,t)}})})}if($("#admin-users-page").length>0){const e={order:[[1,"desc"]],columnDefs:[{targets:0,render:function(e,a,t){return t[2]?'<i class="fas fa-check text-success fa-fw"></i> '+t[1]:'<i class="fas fa-times text-danger fa-fw"></i> '+t[1]},orderable:!1},{targets:1,render:function(e,a,t){return t[0]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return"1970-01-01 00:00:00"===t[5]||"0001-01-01 00:00:00"===t[5]?"":t[5]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){if(t[3]){const e=t[3];let a="";return e.hasOwnProperty("steam")&&(a+='<a class="mr-1" href="/players/'+e.steam+'"><i class="fab fa-steam"></i></a>'),e.hasOwnProperty("discord")&&(a+='<span class="mr-1"><i class="fab fa-discord"></i></span>'),e.hasOwnProperty("google")&&(a+='<span class="mr-1"><i class="fab fa-google"></i></span>'),e.hasOwnProperty("github")&&(a+='<a class="mr-1" href="https://api.github.com/user/'+e.github+'" target="_blank" rel="noopener"><i class="fab fa-google"></i></a>'),e.hasOwnProperty("patreon")&&(a+='<a class="mr-1" href="https://www.patreon.com/user?u='+e.patreon+'" target="_blank" rel="noopener"><i class="fab fa-patreon"></i></a>'),e.hasOwnProperty("twitter")&&(a+='<span class="mr-1"><i class="fab fa-twitter"></i></span>'),a}return""},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:4,render:function(e,a,t){return t[4]>1?t[4]:""},orderSequence:["desc"]}]};$("table.table").gdbTable({tableOptions:e})}if($("#admin-consumers-page").length>0){const e={order:[[0,"desc"]],drawCallback:function(e){const a=this.api();if(a.order()[0]&&0===a.order()[0][0]){const e=a.rows({page:"current"}).nodes();let t=null;a.rows().every(function(a,r,n){let s=this.data()[6];t!==s&&(s?$(e).eq(a).before('<tr class="table-success"><td colspan="6">Active</td></tr>'):$(e).eq(a).before('<tr class="table-danger"><td colspan="6">Expired</td></tr>'),t=s)})}},columnDefs:[{targets:0,render:function(e,a,t){return t[0]},orderSequence:["desc","asc"]},{targets:1,render:function(e,a,t){return t[1]},orderable:!1},{targets:2,render:function(e,a,t){return t[2]},orderable:!1},{targets:3,render:function(e,a,t){return'<a href="https://github.com/gamedb/gamedb/compare/'+t[3]+'...master" target="_blank" rel="noopener">'+t[3]+"</a>"},orderable:!1},{targets:4,render:function(e,a,t){return parseInt(t[4]).toLocaleString()},orderSequence:["desc","asc"]},{targets:5,render:function(e,a,t){return t[5]},orderable:!1}]};$("table.table").gdbTable({tableOptions:e})}if($("#admin-webhooks-page").length>0){$("select.form-control-chosen").chosen({disable_search_threshold:10,allow_single_deselect:!0,rtl:!1});const e={order:[[0,"desc"]],createdRow:function(e,a,t){$(e).addClass("cursor-pointer")},columnDefs:[{targets:0,render:function(e,a,t){return t[0]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,a,t){return t[1]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[2]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(e,a,t){return t[4]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1}]},a=$("table.table"),t=a.gdbTable({tableOptions:e,searchFields:[$("#service")]});a.on("click","tbody tr[role=row]",function(){const e=t.row($(this));e.child.isShown()?(e.child.hide(),$(this).removeClass("shown")):(e.child("<pre>"+JSON.stringify(JSON.parse(e.data()[3]),null,4)+"</pre>").show(),$(this).addClass("shown"))})}if($("#admin-delays-page").length>0){const e={order:[[0,"desc"]],columnDefs:[{targets:0,render:function(e,a,t){return t[2]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:1,render:function(e,a,t){return t[3]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[5].toLocaleString()},orderable:!1}]};$("table.table").gdbTable({tableOptions:e})}const $appPage=$("#app-page");if($appPage.length>0){function loadNews(){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-id",a[0]),$(e).addClass("cursor-pointer")},columnDefs:[{targets:0,render:function(e,a,t){return'<div class="icon-name"><div class="icon"><img class="tall" data-lazy="'+t[10]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"<br /><small>"+t[2]+'</small></div></div><div class="d-none">'+t[5]+"</div>"},createdCell:function(e,a,t,r,n){$(e).attr("style","min-width: 300px;"),$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[4]+'" data-livestamp="'+t[3]+'"></span>'},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1}]},a=$("#news-table"),t=[$("#article-search")],r=a.gdbTable({tableOptions:e,searchFields:t});a.on("click","tbody tr[role=row]",function(){const e=r.row($(this));e.child.isShown()?(e.child.hide(),$(this).removeClass("shown")):(e.child($("<div/>").html(e.data()[5])).show(),$(this).addClass("shown"),observeLazyImages($(this).next().find("img[data-lazy]")))})}function loadAppMediaTab(){$("#media #images img").each(function(){loadImage($(this))}),$("#media #videos video").each(function(){loadVideo($(this))})}function loadItems(){const e={order:[[2,"desc"]],createdRow:function(e,a,t){$(e).attr("data-id",a[0]),$(e).addClass("cursor-pointer")},columnDefs:[{targets:0,render:function(e,a,t){return t[12]},createdCell:function(e,a,t,r,n){},orderable:!1},{targets:1,render:function(e,a,t){return'<div class="icon-name"><div class="icon"><img class="tall" data-lazy="'+t[25]+'" alt="" data-lazy-alt="'+t[16]+'"></div><div class="name">'+t[16]+'<br><small title="'+t[4]+'">'+t[29]+"</small></div></div>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:2,render:function(e,a,t){return t[28]?'<a href="'+t[28]+'" data-src="/assets/img/no-app-image-square.jpg" target="_blank" rel="noopener" class="stop-prop"><i class="fas fa-link"></i></a>':""},orderable:!1}]},a=$("#items-table"),t=[$("#items-search")],r=a.gdbTable({tableOptions:e,searchFields:t});a.on("click","tbody tr[role=row]",function(){const e=r.row($(this));if(e.child.isShown())e.child.hide(),$(this).removeClass("shown");else{const a=e.data(),t=[{Name:"App ID",Value:a[0]},{Name:"Bundle",Value:a[1]},{Name:"Commodity",Value:a[2]},{Name:"Date Created",Value:a[3]},{Name:"Description",Value:a[4]},{Name:"Display Type",Value:a[5]},{Name:"Drop Interval",Value:a[6]},{Name:"Drop Max Per Window",Value:a[7]},{Name:"Exchange",Value:a[8]},{Name:"Hash",Value:a[9]},{Name:"Icon URL",Value:'<a href="'+a[10]+'" target="_blank" rel="noopener">'+a[10]+"</a>"},{Name:"Icon URL Large",Value:'<a href="'+a[11]+'" target="_blank" rel="noopener">'+a[11]+"</a>"},{Name:"Item Def ID",Value:a[12]},{Name:"Item Quality",Value:a[13]},{Name:"Marketable",Value:a[14]},{Name:"Modified",Value:a[15]},{Name:"Name",Value:a[16]},{Name:"Price",Value:a[17]},{Name:"Promo",Value:a[18]},{Name:"Quantity",Value:a[19]},{Name:"Tags",Value:a[20]},{Name:"Timestamp",Value:a[21]},{Name:"Tradable",Value:a[22]},{Name:"Type",Value:a[23]},{Name:"Workshop ID",Value:a[24]}],r=json2html.transform(t,{"<>":"tr",class:"",html:[{"<>":"th",html:"${Name}",class:"nowrap"},{"<>":"td",html:"${Value}"}]});e.child('<table class="table table-hover table-striped table-sm mb-0">'+r+"</table>").show(),$(this).addClass("shown")}})}function loadAppSimilar(){const e=$("#similar-wrapper");$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/similar.html",dataType:"html",success:function(a,t,r){null===a&&(a=""),e.html(a),observeLazyImages(e.find("img[data-lazy]"))}})}function loadAppReviewsChart(){$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/reviews.html",dataType:"html",success:function(e,a,t){null===e&&(e=""),$("#reviews-ajax").html(e)}}),$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/reviews.json",dataType:"json",success:function(e,a,t){null===e&&(e=[]),Highcharts.chart("reviews-chart",$.extend(!0,{},defaultChartOptions,{yAxis:[{allowDecimals:!1,title:{text:""},min:0,max:100,endOnTick:!1,labels:{formatter:function(){return this.value+"%"}}},{allowDecimals:!1,title:{text:""},opposite:!0}],tooltip:{formatter:function(){const e=moment(this.key).format("dddd DD MMM YYYY @ HH:mm");return"Score"===this.series.name?this.y.toLocaleString()+"% Review score on "+e:"Positive Reviews"===this.series.name?this.y.toLocaleString()+" Positive reviews on "+e:"Negative Reviews"===this.series.name?Math.abs(this.y).toLocaleString()+" Negative reviews on "+e:void 0}},series:[{type:"line",name:"Score",color:"#007bff",data:e.mean_reviews_score,yAxis:0,marker:{symbol:"circle"}},{type:"area",name:"Positive Reviews",color:"#28a745",data:e.mean_reviews_positive,yAxis:1,marker:{symbol:"circle"}},{type:"area",name:"Negative Reviews",color:"#e83e8c",data:e.mean_reviews_negative,yAxis:1,marker:{symbol:"circle"}}]}))}})}function loadAppPlayersChart(){const e=new Date;e.setDate(e.getDate()-7);const a=$.extend(!0,{},defaultChartOptions,{yAxis:{allowDecimals:!1,title:{text:""},min:0,opposite:!1,labels:{formatter:function(){return this.value.toLocaleString()}},visible:!0},plotOptions:{series:{marker:{enabled:!1}}},tooltip:{formatter:function(){switch(this.series.name){case"Players Online":return this.y.toLocaleString()+" players on "+moment(this.key).format("dddd DD MMM YYYY @ HH:mm");case"Players Online (Average)":return this.y.toLocaleString()+" average players on "+moment(this.key).format("dddd DD MMM YYYY @ HH:mm");case"Twitch Viewers":return this.y.toLocaleString()+" Twitch viewers on "+moment(this.key).format("dddd DD MMM YYYY @ HH:mm");case"YouTube Views":return this.y.toLocaleString()+" YouTube views on "+moment(this.key).format("dddd DD MMM YYYY");case"YouTube Comments":return this.y.toLocaleString()+" YouTube comments on "+moment(this.key).format("dddd DD MMM YYYY")}}}}),t=function(e){let a=[{name:"Twitch Viewers",color:"#6441A4",data:e.max_twitch_viewers,connectNulls:!0,visible:!1},{name:"Players Online (Average)",color:"#28a74544",data:e.max_moving_average,connectNulls:!0},{name:"Players Online",color:"#28a745",data:e.max_player_count,connectNulls:!0}];return user.isLoggedIn&&a.unshift({name:"YouTube Comments",color:"#ff0000",data:e.max_youtube_comments,connectNulls:!0,type:"line",step:"right",visible:!1},{name:"YouTube Views",color:"#ff0000",data:e.max_youtube_views,connectNulls:!0,type:"line",step:"right",visible:!1}),a};$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/players.json",dataType:"json",success:function(r,n,s){if(null===r){const e=Date.now();r={max_player_count:[[e,0]],max_moving_average:[[e,0]],max_twitch_viewers:[[e,0]],max_youtube_views:[[e,0]],max_youtube_comments:[[e,0]]}}const o=e.getTime();let l=0;isIterable(r.max_youtube_views)&&r.max_youtube_views.forEach(function(e,a,t){e[0]>o&&null!=e[1]&&e[1]>l&&(l=e[1])}),$("#youtube-max-views").html(l.toLocaleString()),l=0,isIterable(r.max_youtube_comments)&&r.max_youtube_comments.forEach(function(e,a,t){e[0]>o&&null!=e[1]&&e[1]>l&&(l=e[1])}),$("#youtube-max-comments").html(l.toLocaleString()),Highcharts.chart("players-chart",$.extend(!0,{},a,{xAxis:{min:e.getTime()},series:t(r)}))}}),$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/players2.json",dataType:"json",success:function(e,r,n){if(null===e){const a=Date.now();e={max_player_count:[[a,0]],max_moving_average:[[a,0]],max_twitch_viewers:[[a,0]],max_youtube_views:[[a,0]],max_youtube_comments:[[a,0]]}}Highcharts.chart("players-chart2",$.extend(!0,{},a,{chart:{zoomType:"x"},series:t(e)}))}})}function loadAppPlayersHeatmapChart(){$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/players-heatmap.json",dataType:"json",success:function(e,a,t){null===e&&(e={max_player_count:[]});const r=Math.floor(moment().utcOffset()/60),n=moment.tz(moment.tz.guess()).zoneAbbr();if(Math.abs(r)>0){let a=e.max_player_count;a.forEach(function(e,t){a[t][0]+=r,a[t][0]>23?(a[t][0]-=24,a[t][1]++):a[t][0]<0&&(a[t][0]+=24,a[t][1]--),a[t][1]>6?a[t][1]-=7:a[t][1]<0&&(a[t][1]+=7)}),e={max_player_count:a}}Highcharts.chart("players-heatmap-chart",$.extend(!0,{},defaultChartOptions,{chart:{type:"heatmap"},xAxis:{title:null,type:"category",lineColor:"rgba(0,0,0,0)"},yAxis:{categories:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],title:null,reversed:!0,gridLineColor:"rgba(0,0,0,0)"},legend:{enabled:!0,align:"right",layout:"vertical",verticalAlign:"middle"},tooltip:{formatter:function(){const e=this.series.yAxis.categories[this.point.y],a=this.point.x;return"Average of last 4 "+e+"s @ "+pad(a,2)+":00-"+pad(a,2)+":59 "+n+": ~"+Math.round(this.point.value).toLocaleString()+" players"}},colorAxis:{minColor:darkMode?"#212529":"#FFFFFF",maxColor:defaultChartOptions.colors[0],reversed:!1},plotOptions:{series:{marker:{enabled:!0}}},series:[{data:e.max_player_count,borderWidth:0}]}))}})}function loadAppWishlist(){$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/wishlist.json",dataType:"json",success:function(e,a,t){null===e&&(e={}),Highcharts.chart("wishlists-chart",$.extend(!0,{},defaultChartOptions,{yAxis:[{title:{text:""},labels:{formatter:function(){return this.value.toLocaleString()}}},{title:{text:"Wishlists"},labels:{formatter:function(){return this.value.toFixed(7)+"%"}}},{opposite:!0,reversed:!0,title:{text:"Average Position"},labels:{formatter:function(){return this.value.toLocaleString()}}}],tooltip:{formatter:function(){switch(this.series.name){case"Wishlists":return"In "+this.y.toLocaleString()+" wishlists on "+moment(this.key).format("dddd DD MMM YYYY");case"Wishlists %":return"In "+this.y.toFixed(7)+"% of wishlists on "+moment(this.key).format("dddd DD MMM YYYY");case"Average Position":return"Average position of "+this.y.toFixed(2).toLocaleString()+" on "+moment(this.key).format("dddd DD MMM YYYY")}}},series:[{name:"Wishlists",color:"#007bff",data:e.mean_wishlist_count,marker:{symbol:"circle"},yAxis:0},{name:"Wishlists %",color:"#28a745",data:e.mean_wishlist_percent,marker:{symbol:"circle"},yAxis:1},{name:"Average Position",color:"#e83e8c",data:e.mean_wishlist_avg_position,marker:{symbol:"circle"},yAxis:2}]}))}})}function loadAppPlayerTimes(){const e={order:[[3,"desc"]],createdRow:function(e,a,t){$(e).attr("data-id",a[0]),$(e).attr("data-link",a[6])},columnDefs:[{targets:0,render:function(e,a,t){return t[4]},createdCell:function(e,a,t,r,n){$(e).addClass("font-weight-bold")},orderable:!1},{targets:1,render:function(e,a,t){return t[3]?'<img data-lazy="'+t[3]+'" alt="" data-lazy-alt="'+t[7]+'" class="wide" data-toggle="tooltip" data-placement="left" data-lazy-title="'+t[7]+'" class="rounded">':""},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:2,render:function(e,a,t){return'<a href="'+t[6]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[5]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:3,render:function(e,a,t){return t[2]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1}]};$("#top-players-table").gdbTable({tableOptions:e})}function loadAchievements(){$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/achievement-counts.json",dataType:"json",success:function(e,a,t){if(null===e&&(e={}),e.hasOwnProperty("data")||(e.data=[]),!e.data)return void $("#achievement-counts-chart").css("height","auto").html("No data");let r=[{value:e.marker,color:"red",width:1,zIndex:3,label:{formatter:function(){return"You are here!"}}}];Highcharts.chart("achievement-counts-chart",$.extend(!0,{},defaultChartOptions,{legend:{enabled:!1},yAxis:{allowDecimals:!1,title:{text:""},min:0},xAxis:{type:"category",plotLines:r},tooltip:{formatter:function(){return this.y.toLocaleString()+" players have "+this.x.toLocaleString()+" achievements"}},series:[{data:e.data}]}))}}),$("#achievements-table").gdbTable({tableOptions:{pageLength:1e3,order:[[2,"desc"]],columnDefs:[{targets:0,render:function(e,a,t){let r=t[0];return t[4]||(r+='<span class="badge badge-danger float-right ml-1">Inactive</span>'),t[5]&&(t[1]="<em>&lt;Hidden&gt;</em> "+t[1]),t[6]&&(r+='<span class="badge badge-danger float-right ml-1">Deleted</span>'),r+="<br><small>"+t[1]+"</small>",'<div class="icon-name"><div class="icon"><img class="tall" data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[0]+'"></div><div class="name">'+r+"</div></div>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[7]&&t[7]>0?'<span data-livestamp="'+t[7]+'"></span><br><small class="text-muted">'+t[8]+"</small>":""},orderable:!1},{targets:2,render:function(e,a,t){return t[3]+"%"},createdCell:function(e,a,t,r,n){t[3]=Math.ceil(t[3]),$(e).css("background","linear-gradient(to right, rgba(0,0,0,.15) "+t[3]+"%, transparent "+t[3]+"%)"),$(e).addClass("thin")},orderSequence:["desc","asc"]}]}})}function loadDLC(){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[5])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[5]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderSequence:["asc","desc"]},{targets:1,render:function(e,a,t){return t[3]?'<span data-toggle="tooltip" data-placement="left" title="'+t[4]+'" data-livestamp="'+t[3]+'"></span>':t[4]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]}]},a=[$("#dlc-search")];$("#dlc-table").gdbTable({tableOptions:e,searchFields:a})}function loadAppBundlesTab(){const e={serverSide:!1,order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[1])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[1]+'" class="icon-name"><div class="icon"><img data-lazy="/assets/img/no-app-image-square.jpg" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[2]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderSequence:["asc","desc"]},{targets:1,render:function(e,a,t){return t[3]+"%"},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[5].toLocaleString()},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[6]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]}]};$("#bundles-table").gdbTable({tableOptions:e})}function loadAppPackagesTab(){const e={serverSide:!1,order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[1])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[1]+'" class="icon-name"><div class="icon"><img data-lazy="/assets/img/no-app-image-square.jpg" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[2]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderSequence:["asc","desc"]},{targets:1,render:function(e,a,t){return t[3]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["asc","desc"]},{targets:2,render:function(e,a,t){return t[4]},orderSequence:["asc","desc"]},{targets:3,render:function(e,a,t){return t[5]},orderSequence:["asc","desc"]},{targets:4,render:function(e,a,t){return t[6]},orderSequence:["desc","asc"]}]};$("#packages-table").gdbTable({tableOptions:e})}function loadDevLocalization(){$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/localization.html",dataType:"html",success:function(e,a,t){null===e&&(e=""),$("#dev-localization").html(e)}})}function loadAppTags(){$.ajax({type:"GET",url:"/games/"+$appPage.attr("data-id")+"/tags.json",dataType:"json",success:function(e,a,t){let r=[];if(isIterable(e.order))for(const a of e.order)r.push({name:e.names[a],data:e.counts["tag_"+a.toString()]});Highcharts.chart("tags-chart",$.extend(!0,{},defaultChartOptions,{yAxis:{title:{text:"Votes"}},series:r}))}})}$("#scroll-to-videos").on("mouseup",function(e){const a=$("#videos");$("html, body").animate({scrollTop:a.offset().top-15},500);const t=a.find("video");t[0].paused&&t.first().trigger("click")}),$("#details video").on("mouseup",function(e){const a=$(this)[0];a.paused?a.play():($('a.nav-link[href="#media"]').tab("show"),$("#scroll-to-videos").trigger("mouseup"))}),$("#dev-info").on("mouseup","tr",function(){const e=$(this),a=$(this).closest("table").DataTable().row(e);a.child.isShown()?(a.child.hide(),e.removeClass("shown")):(a.child(function(){return'<code class="wbba">'+e.data("raw")+"</code>"}).show(),e.addClass("shown"))}),loadAjaxOnObserve({news:loadNews,items:loadItems,prices:loadPriceChart,"similar-wrapper":loadAppSimilar,reviews:loadAppReviewsChart,achievements:loadAchievements,dlc:loadDLC,"dev-localization":loadDevLocalization,media:loadAppMediaTab,"tags-chart":loadAppTags,"bundles-table":loadAppBundlesTab,"packages-table":loadAppPackagesTab,"players-chart":loadAppPlayersChart,"players-heatmap-chart":loadAppPlayersHeatmapChart,"group-chart":function(){loadGroupChart($appPage)},"top-players-table":loadAppPlayerTimes,"wishlists-chart":loadAppWishlist}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){"#media"===$(e.relatedTarget).attr("href")&&pauseAllVideos()}),user.toasts&&user.toasts.length>0&&websocketListener("app",function(e){JSON.parse(e.data).Data.toString()===$appPage.attr("data-id")&&toast(!0,"Click to refresh","This app has been updated",0,"refresh")})}const $appsAchievementsPage=$("#apps-achievements-page");if($appsAchievementsPage.length>0){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img alt="" data-lazy="'+t[2]+'" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[5].toLocaleString()},orderSequence:["desc"]},{targets:2,render:function(e,a,t){return t[6].toLocaleString()+"%"},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[4]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:4,render:function(e,a,t){return isIterable(t[7])?json2html.transform(t[7],{"<>":"img",src:"","data-lazy":"${k}","data-lazy-alt":"${v}",class:"mr-1","data-toggle":"tooltip","data-placement":"top","data-lazy-title":"${v}"}):""},createdCell:function(e,a,t,r,n){$(e).addClass("img"),$(e).attr("nowrap","nowrap")},orderable:!1}]},a=[$("#search")];$("table.table").gdbTable({tableOptions:e,searchFields:a})}const $appsComparePage=$("#apps-compare-page");if($appsComparePage.length>0){function loadCompareSearchTable(){const e={order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[1])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[4]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[3]+'" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[2]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[6]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[8]?'<a href="'+t[7]+'" ><i class="fas fa-minus"></i> Remove</a>':'<a href="'+t[7]+'" ><i class="fas fa-plus"></i> Add</a>'},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(e,a,t){return t[5]?'<a href="'+t[5]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1},{targets:4,render:function(e,a,t){return t[9]},orderable:!1,visible:!1}]},a=$("#ids"),t=$("#search");$("#search-table").gdbTable({tableOptions:e,searchFields:[a,t]}).on("draw.dt",function(e,a){t.val()?$("#search-results").show():$("#search-results").hide()}),$("#apps-table").gdbTable({tableOptions:e,searchFields:[a]})}function loadComparePlayersChart(){if($.isEmptyObject(appNames))return;const e=$.extend(!0,{},defaultChartOptions,{yAxis:{allowDecimals:!1,title:{text:""},min:0,opposite:!1,labels:{formatter:function(){return this.value.toLocaleString()}},visible:!0},plotOptions:{series:{marker:{enabled:!1}}},tooltip:{formatter:function(){return this.series.name+" had "+this.y.toLocaleString()+" players on "+moment(this.key).format("dddd DD MMM YYYY @ HH:mm")}}});$.ajax({type:"GET",url:"/games/compare/"+$appsComparePage.attr("data-id")+"/players.json",dataType:"json",cache:!0,success:function(a,t,r){let n=[];for(const e of a)n.push({name:appNames[e.key],data:e.value.max_player_count,connectNulls:!0});Highcharts.chart("players-chart",$.extend(!0,{},e,{series:n}))}}),$.ajax({type:"GET",url:"/games/compare/"+$appsComparePage.attr("data-id")+"/players2.json",dataType:"json",cache:!0,success:function(a,t,r){let n=[];for(const e of a)n.push({name:appNames[e.key],data:e.value.max_player_count,connectNulls:!0});Highcharts.chart("players-chart2",$.extend(!0,{},e,{series:n}))}})}function loadCompareFollowersChart(e=null){$.isEmptyObject(groupNames)||$.ajax({type:"GET",url:"/games/compare/"+$appsComparePage.attr("data-group-id")+"/members.json",dataType:"json",cache:!0,success:function(e,a,t){let r=[];for(const a of e)r.push({name:groupNames[a.key],data:a.value.max_members_count,connectNulls:!0});Highcharts.chart("group-chart",$.extend(!0,{},defaultChartOptions,{yAxis:{allowDecimals:!1,title:{text:""},labels:{formatter:function(){return this.value.toLocaleString()}}},tooltip:{formatter:function(){return this.series.name+" had members on "+moment(this.key).format("dddd DD MMM YYYY @ HH:mm")}},series:r}))}})}function loadCompareScoreChart(){$.isEmptyObject(appNames)||$.ajax({type:"GET",url:"/games/compare/"+$appsComparePage.attr("data-id")+"/reviews.json",dataType:"json",cache:!0,success:function(e,a,t){let r=[];for(const a of e)r.push({name:appNames[a.key],data:a.value.mean_reviews_score,connectNulls:!0});Highcharts.chart("score-chart",$.extend(!0,{},defaultChartOptions,{yAxis:{allowDecimals:!1,title:{text:""},min:0,max:100,endOnTick:!1,labels:{formatter:function(){return this.value+"%"}}},tooltip:{formatter:function(){return this.series.name+" had a review score of "+this.y.toLocaleString()+"% on "+moment(this.key).format("dddd DD MMM YYYY @ HH:mm")}},series:r}))}})}function loadComparePriceChart(){$.isEmptyObject(appNames)||$.ajax({type:"GET",url:"/games/compare/"+$appsComparePage.attr("data-id")+"/prices.json",dataType:"json",cache:!0,success:function(e,a,t){let r=[];for(const a of e)r.push({name:appNames[a.key],data:a.value.price,type:"line",step:"left"});Highcharts.chart("price-chart",$.extend(!0,{},defaultChartOptions,{yAxis:{title:{text:"Price ("+user.userCurrencySymbol+")"},allowDecimals:!0,min:0},series:r}))}})}function loadCompareWishlistChart(){$.isEmptyObject(appNames)||$.ajax({type:"GET",url:"/games/compare/"+$appsComparePage.attr("data-id")+"/wishlists.json",dataType:"json",cache:!0,success:function(e,a,t){let r=[];for(const a of e)r.push({name:appNames[a.key],data:a.value.mean_wishlist_count,connectNulls:!0});Highcharts.chart("wishlists-chart",$.extend(!0,{},defaultChartOptions,{yAxis:{allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){return this.series.name+" is in "+this.y.toLocaleString()+" wishlists on "+moment(this.key).format("dddd DD MMM YYYY")}},series:r}))}})}loadAjaxOnObserve({"apps-table":loadCompareSearchTable,"players-chart":loadComparePlayersChart,"group-chart":loadCompareFollowersChart,"score-chart":loadCompareScoreChart,"wishlists-chart":loadCompareWishlistChart,"price-chart":loadComparePriceChart})}$("#apps-page").length>0&&function(e,a){"use strict";e("select.form-control-chosen").chosen({disable_search_threshold:10,allow_single_deselect:!0,rtl:!1,max_selected_options:10});const t=e("#price-slider"),r=noUiSlider.create(t[0],{start:[0,100],connect:!0,step:1,range:{min:0,max:100}}),n=e("#score-slider"),s=noUiSlider.create(n[0],{start:[0,100],connect:!0,step:1,range:{min:0,max:100}});function o(a){const t=r.get();t[0]===t[1]?e("label#price-label").html("Price ("+user.userCurrencySymbol+Math.round(t[0])+")"):e("label#price-label").html("Price ("+user.userCurrencySymbol+Math.round(t[0])+" - "+user.userCurrencySymbol+Math.round(t[1])+")");const n=s.get();n[0]===n[1]?e("label#score-label").html("Score ("+Math.round(n[0])+"%)"):e("label#score-label").html("Score ("+Math.round(n[0])+"% - "+Math.round(n[1])+"%)")}window.updateLabels=o,e(o);const l={order:[[2,"desc"]],createdRow:function(a,t,r){e(a).attr("data-app-id",t[0]),e(a).attr("data-link",t[3])},columnDefs:[{targets:0,render:function(e,a,t){return t[9].toLocaleString()},orderable:!1},{targets:1,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[12]+"</div></a>"},createdCell:function(a,t,r,n,s){e(a).addClass("img")},orderable:!1},{targets:2,render:function(e,a,t){return t[7].toLocaleString()},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[10].toLocaleString()},orderSequence:["desc"]},{targets:4,render:function(e,a,t){return t[5]+"%"},orderSequence:["desc"]},{targets:5,render:function(e,a,t){return t[6]},orderSequence:["desc"]},{targets:6,render:function(e,a,t){return t[8]?'<a href="'+t[8]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1},{targets:7,render:function(e,a,t){return t[11]},orderable:!1,visible:!1}]},i=e("#platforms"),c=[e("#tags"),e("#genres"),e("#categories"),e("#developers"),e("#publishers"),e("#types"),e("#search"),i,t,n];e("table.table").gdbTable({tableOptions:l,searchFields:c})}(jQuery,document),$("#apps-random-page").length>0&&($("#find-another").on("click",function(e){window.location.reload(!0)}),$("select.form-control-chosen").chosen({disable_search_threshold:10,allow_single_deselect:!0,rtl:!1,max_selected_options:1}),$("#search-card select").on("change",function(e){const a=new URLSearchParams(location.search);$(this).val()?a.set($(this).attr("name"),$(this).val()):a.delete($(this).attr("name")),window.location.href=window.location.pathname+"?"+a.toString()}),$(function(){const e=$("#search-card select");window.location.search&&e.deserialize(window.location.search.replace("?","")),e.trigger("chosen:updated")})),$("#release-dates-page").length>0&&$("table.table").gdbTable({tableOptions:{order:[[4,"asc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img"),$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,a,t){return t[6]},orderable:!1},{targets:2,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[5]?'<a href="'+t[5]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1},{targets:4,render:function(e,a,t){return t[7]},visible:user.isLocal,orderable:!1,orderSequence:["asc","desc"]}]}});const $trendingAppsPage=$("#trending-apps-page"),$trendingAppsTable=$("table.table");if($trendingAppsPage.length>0){const e={order:[[3,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img alt="" data-lazy="'+t[2]+'" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[4]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[6].toLocaleString()},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[5].toLocaleString()},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return'<div data-app-id="'+t[0]+'"><i class="fas fa-spinner fa-spin"></i></div>'},createdCell:function(e,a,t,r,n){$(e).addClass("chart")},orderable:!1}]};$trendingAppsTable.gdbTable({tableOptions:e})}if($trendingAppsPage.length>0||$("#new-releases-page").length>0){function loadCharts(){const e=$("td.chart div[data-app-id]").map(function(){return $(this).attr("data-app-id")}).get().join(",");$.ajax({type:"GET",url:"/games/trending/charts.json?ids="+e,dataType:"json",success:function(e,a,t){null!==e&&$("div[data-app-id]").each(function(a){let t;const r=$(this).attr("data-app-id");t=null!==e&&r in e&&"max_player_count"in e[r]?e[r].max_player_count:[],Highcharts.chart(this,$.extend(!0,{},defaultChartOptions,{chart:{type:"area",margin:[0,0,0,0],skipClone:!0,height:32},legend:{enabled:!1},xAxis:{labels:{enabled:!1}},yAxis:{title:{text:null},labels:{enabled:!1},min:0},plotOptions:{series:{marker:{enabled:!1}}},tooltip:{hideDelay:0,outside:!0,shared:!0,formatter:function(){return this.y.toLocaleString()+" players on "+moment(this.x).format("dddd DD MMM YYYY @ HH:mm")},style:{width:"500px"}},series:[{color:"#28a745",data:t}]}))})}})}$trendingAppsTable.on("draw.dt",function(e,a,t){loadCharts()})}const $badgePage=$("#badge-page");if($badgePage.length>0){const e={order:[[2,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[5])},columnDefs:[{targets:0,render:function(e,a,t){return t[0]}},{targets:1,render:function(e,a,t){return'<a href="'+t[5]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")}},{targets:2,render:function(e,a,t){return t[3].toLocaleString()}},{targets:3,render:function(e,a,t){return t[4]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")}},{targets:4,render:function(e,a,t){return t[6]?'<a href="'+t[6]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("table.table").gdbTable({tableOptions:e})}const $bundlePage=$("#bundle-page");if($bundlePage.length>0&&$.ajax({type:"GET",url:"/bundles/"+$bundlePage.attr("data-id")+"/prices.json",dataType:"json",success:function(e,a,t){null===e&&(e=[]),Highcharts.chart("prices-chart",$.extend(!0,{},defaultChartOptions,{legend:{enabled:!1},tooltip:{formatter:function(){return this.y.toLocaleString()+"% discount on "+moment(this.x).format("dddd DD MMM YYYY @ HH:mm")}},xAxis:{labels:{step:1,formatter:function(){return moment(this.value).format("Do MMM YY")}}},yAxis:{title:{text:"Discount (%)"},type:"linear",max:0,min:-100,allowDecimals:!1,reversed:!0},series:[{type:"line",name:"Price",step:"left",color:"#28a745",data:e}]}))}}),$("#bundles-page").length>0){const e={order:[[4,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[2])},columnDefs:[{targets:0,render:function(e,a,t){let r=t[1];return t[7]&&(r+=' <span class="badge badge-success">Lowest</span>'),'<a href="'+t[2]+'" class="icon-name"><div class="icon"><img src="/assets/img/no-app-image-square.jpg" alt="'+t[1]+'"></div><div class="name">'+r+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[4]+"%"},orderSequence:["asc"]},{targets:2,render:function(e,a,t){return t[5].toLocaleString()},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[6].toLocaleString()},orderSequence:["desc"]},{targets:4,createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},render:function(e,a,t){return'<span data-livestamp="'+t[3]+'"></span>'}},{targets:5,render:function(e,a,t){return t[8]?'<a href="'+t[8]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]},a=$("table.table"),t=a.gdbTable({tableOptions:e});websocketListener("bundles",function(r){const n=t.page.info();if(0===n.page){const t=JSON.parse(r.data);addDataTablesRow(e,t.Data,n.length,a)}})}if($("#changes-page").length>0){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[5])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[5]+'" class="icon-name"><div class="icon"><img src="/assets/img/no-app-image-square.jpg" alt="'+t[1]+'"></div><div class="name">'+t[6]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap"),$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[2]+'" data-livestamp="'+t[1]+'"></span>'},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){let r=[];if(null!==t[3])for(let e in t[3])t[3].hasOwnProperty(e)&&(""===t[3][e].name&&(t[3][e].name="Unknown App"),r.push('<a href="'+t[3][e].path+'">'+t[3][e].name+"</a>"));return r.join("<br/>")},orderable:!1},{targets:3,render:function(e,a,t){let r=[];if(null!==t[4])for(let e in t[4])t[4].hasOwnProperty(e)&&(""===t[4][e].name&&(t[4][e].name="Unknown Package"),r.push('<a href="'+t[4][e].path+'">'+t[4][e].name+"</a>"));return r.join("<br/>")},orderable:!1}]},a=$("table.table"),t=a.gdbTable({tableOptions:e});websocketListener("changes",function(r){const n=t.page.info();if(0===n.page){const t=JSON.parse(r.data);if(isIterable(t.Data)){t.Data.sort(function(e,a){return Math.sign(e[0]-a[0])});for(const r of t.Data)addDataTablesRow(e,r,n.length,a)}}})}if($("#chat-page").length>0){const e=$("[data-channel-id]").attr("data-channel-id");function chatRow(e,a=!0){const t=$("ul[data-channel-id="+e.channel+"]"),r=a?" fade-green":"";!e.content&&e.embeds&&(e.content="<small>Media content not available on gamedb.online, please view in Discord</small>"),t.json2html(e,{"<>":"li",class:"media fade-in",style:"animation-delay: ${i}s",html:[{"<>":"img",class:"mr-3 rounded",alt:"","data-lazy-alt":"${author_user}","data-lazy":function(e,a){return e.author_avatar?"https://cdn.discordapp.com/avatars/"+e.author_id+"/"+e.author_avatar+".png?size=64":"/assets/img/no-app-image-square.jpg"}},{"<>":"div",class:"media-body",html:[{"<>":"h5",class:"mt-0 mb-1 rounded"+r,html:"${content}"},{"<>":"p",class:"text-muted",html:"By ${author_user}"}]}]},{prepend:a}),t.find("li").slice(50).remove(),observeLazyImages(t.find("img[data-lazy]"))}$.ajax({url:"/chat/"+e+"/chat.json",dataType:"json",cache:!1,success:function(e,a,t){if($(".fa-spin").remove(),isIterable(e))for(const a of e)chatRow(a,!1)}}),websocketListener("chat",function(e){chatRow(JSON.parse(e.data).Data)})}if($("#chat-bot-page").length>0){const e={order:[[2,"desc"]],columnDefs:[{targets:0,render:function(e,a,t){return'<div class="icon-name"><div class="icon"><img class="tall" alt="" data-lazy="https://cdn.discordapp.com/avatars/'+t[0]+"/"+t[2]+'.png?size=64" data-lazy-alt="'+t[1]+'"></div><div class="name nowrap">'+t[1]+"<br><small>"+t[6]+"</small></div></div>"},createdCell:function(e,a,t,r,n){$(e).addClass("img thin"),$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,a,t){return t[3]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[4]&&t[4]>0?'<span data-livestamp="'+t[4]+'"></span><br><small class="text-muted">'+t[5]+"</small>":""},createdCell:function(e,a,t,r,n){$(e).addClass("thin"),$(e).attr("nowrap","nowrap")},orderable:!1}]},a=$("#recent-table"),t=a.gdbTable({tableOptions:e});websocketListener("chat-bot",function(r){const n=t.page.info();if(0===n.page){const t=JSON.parse(r.data);addDataTablesRow(e,t.Data.row_data,n.length,a)}})}if($("#commits-page").length>0){const e=$("table.table");let a=null;const t={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[3]),$(e).attr("data-target","_blank")},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" target="_blank" class="icon-name"><div class="name">'+t[0]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).attr("id",t[4]),$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[2]+'" data-livestamp="'+t[1]+'"></span>'},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[4]},orderable:!1},{targets:3,render:function(t,r,n){return null===a&&(a=e.DataTable().page.info().page),n[5]||a>0?'<i class="fas fa-check text-success"></i>':'<i class="fas fa-times text-danger"></i>'},orderable:!1}]};e.gdbTable({tableOptions:t}).on("draw.dt",function(e,t){a=null})}if($("#coop-page").length>0){const e=$("#ids"),a=$("#search");function loadCoopSearchTable(){const t={order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-player-id",a[1])},language:{zeroRecords:function(){return'No matching players found on Game DB. If a player is missing, <a href="/players/add?search='+a.val()+'">add them here</a>.'}},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[4]+'" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[10]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[0]?t[0].toLocaleString():$lockIcon},orderable:!1},{targets:2,render:function(e,a,t){return t[6].toLocaleString()},orderable:!1},{targets:3,render:function(e,a,t){return t[8]?'<a href="'+t[7]+'" ><i class="fas fa-minus"></i> Remove</a>':'<a href="'+t[7]+'" ><i class="fas fa-plus"></i> Add</a>'},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:4,render:function(e,a,t){return t[5]?'<a href="'+t[5]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1},{targets:5,render:function(e,a,t){return t[9]},orderable:!1,visible:!1}]};$("#search-table").gdbTable({tableOptions:t,searchFields:[e,a]}).on("draw.dt",function(e,t){a.val()?$("#search-results").show():$("#search-results").hide()}),$("#players-table").gdbTable({tableOptions:t,searchFields:[e]})}function loadCoopGamesTable(){const a={order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[7])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[7]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[3]},createdCell:function(e,a,t,r,n){$(e).addClass("platforms")},orderable:!1},{targets:2,render:function(e,a,t){return t[4].toLocaleString()},orderable:!1},{targets:3,render:function(e,a,t){return t[5]},orderable:!1},{targets:4,render:function(e,a,t){return t[6]?'<a href="'+t[6]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("#games-table").gdbTable({tableOptions:a,searchFields:[e]})}loadCoopSearchTable(),loadCoopGamesTable()}if($("#donate-page").length>0){const e={order:[[1,"desc"]],createdRow:function(e,a,t){a[0]>0&&$(e).attr("data-link",a[2])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[2]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[3]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return"$"+t[5].toLocaleString()},orderable:!1}]};$("#top-donations").gdbTable({tableOptions:e}),$("#new-donations").gdbTable({tableOptions:e})}const $xpPage=$("#experience-page");if($xpPage.length>0){function scroll(){if("string"==typeof scrollTo){const e=$(scrollTo).offset().top-100;$("html, body").animate({scrollTop:e},500),$("tr").removeClass("table-success"),$(scrollTo).addClass("table-success")}}function levelToXP(e){let a=0;for(let t=0;t<=e;t++)a+=100*Math.ceil(t/10);return a}function update(){const e=$("#answer");e.val("Loading..");let a=$("#from").val();a<1&&(a=1);let t=$("#to").val();t<1&&(t=1),e.val((levelToXP(t)-levelToXP(a)).toLocaleString())}$xpPage.on("click","tr[data-level]",function(e){const a=$(this).attr("data-level");history.pushState&&history.pushState("data","","/experience/"+a),scrollTo="tr[data-level="+a+"]",scroll()}),$("#from, #to").on("change",update),$("#calculate").on("click",function(e){e.preventDefault(),update()}),$(function(e){scroll(),update()})}const $groupPage=$("#group-page");if($groupPage.length>0){function loadGroupPlayers(){const e={order:[[2,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[3]),$(e).attr("data-app-id",a[0])},columnDefs:[{targets:0,render:function(e,a,t){if(t[6]){const e='<img data-lazy="'+t[4]+'" alt="" data-lazy-alt="'+t[6]+'" class="wide" data-toggle="tooltip" data-placement="left" data-lazy-title="'+t[6]+'">';return'<a href="/players?country='+t[6]+'">'+e+"</a>"}return""},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return'<a href="'+t[8]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[3]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:2,render:function(e,a,t){return'<div class="icon-name"><div class="icon"><div class="'+t[7]+'"></div></div><div class="name min nowrap">'+t[5].toLocaleString()+"</div></div>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[9].toLocaleString()},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[2]?'<a href="'+t[2]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("#players").gdbTable({tableOptions:e,searchFields:[$("#items-search")]})}websocketListener("group",function(e){JSON.parse(e.data).Data.toString()===$groupPage.attr("data-id")&&toast(!0,"Click to refresh","This group has been updated",0,"refresh")}),loadAjaxOnObserve({"group-chart":function(){loadGroupChart($groupPage)},players:loadGroupPlayers})}function loadGroupChart(e){const a=$("#group-chart");if(0===a.length)return;let t=[];""!==a.attr("data-release")&&t.push({value:1e3*parseInt(a.attr("data-release")),color:"red",width:1,zIndex:3,label:{formatter:function(){return"Steam Release"}}}),$.ajax({type:"GET",url:"/groups/"+e.attr("data-group-id")+"/members.json",dataType:"json",success:function(e,a,r){null===e&&(e=[]),Highcharts.chart("group-chart",$.extend(!0,{},defaultChartOptions,{xAxis:{plotLines:t},yAxis:{allowDecimals:!1,title:{text:""},labels:{formatter:function(){return this.value.toLocaleString()}}},tooltip:{formatter:function(){switch(this.series.name){case"In Chat":return this.y.toLocaleString()+" members in chat on "+moment(this.key).format("dddd DD MMM YYYY");case"In Game":return this.y.toLocaleString()+" members in game on "+moment(this.key).format("dddd DD MMM YYYY");case"Online":return this.y.toLocaleString()+" members online "+moment(this.key).format("dddd DD MMM YYYY");case"Members":return this.y.toLocaleString()+" members on "+moment(this.key).format("dddd DD MMM YYYY")}}},series:[{name:"In Chat",color:"#007bff",data:e.max_members_in_chat,marker:{symbol:"circle"},visible:!1},{name:"In Game",color:"#e83e8c",data:e.max_members_in_game,marker:{symbol:"circle"},visible:!1},{name:"Members",color:"#28a745",data:e.max_members_count,marker:{symbol:"circle"}}]}))}})}if($("#groups-page").length>0){$("select.form-control-chosen").chosen({disable_search_threshold:10,allow_single_deselect:!0,rtl:!1,max_selected_options:1});const e={order:[[3,"desc"]],createdRow:function(e,a,t){$(e).attr("data-group-id",a[0]),$(e).attr("data-link",a[10]),a[8]&&$(e).addClass("table-danger")},columnDefs:[{targets:0,render:function(e,a,t){return t[9].toLocaleString()},orderable:!1},{targets:1,render:function(e,a,t){let r=t[12]+"<br><small>"+t[4]+"</small>";return t[8]&&(r+='<span class="badge badge-danger float-right">Removed</span>'),'<a href="'+t[10]+'" class="icon-name"><div class="icon"><img class="tall" data-src="/assets/img/no-app-image-square.jpg" data-lazy="'+t[5]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+r+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:2,render:function(e,a,t){return t[13].toLocaleString()},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[6].toLocaleString()},orderSequence:["desc"]},{targets:4,render:function(e,a,t){return t[7]},orderSequence:["desc","asc"]},{targets:5,render:function(e,a,t){return t[11]},orderable:!1,visible:!1},{targets:6,render:function(e,a,t){return t[2]?'<a href="'+t[2]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("table.table").gdbTable({tableOptions:e,searchFields:[$("#search"),$("#filter")]})}const $homePage=$("#home-page");if($homePage.length>0){$homePage.on("click","#sales span[data-sort]:not(.badge-success)",function(e){loadSales($(this).attr("data-sort"))}),$homePage.on("click","#players span[data-sort]:not(.badge-success)",function(e){loadPlayers($(this).attr("data-sort"))});let e=0;const a=$("#panels .card");function loadHomeTweets(){$.ajax({url:"/home/tweets.json",dataType:"json",cache:!0,success:function(e,a,t){if(isIterable(e)){$("#tweets .card-body").empty().json2html(e,{"<>":"div",class:"tweet",target:"_blank",rel:"noopener","data-link":"${link}",html:[{"<>":"p",html:'<i class="fas fa-star"></i> ${text}'}]},{prepend:!1})}}})}function loadNewsSection(){const e=$("#news");$.ajax({type:"GET",url:"/home/news.html",dataType:"html",success:function(a,t,r){null===a&&(a=""),e.html(a),observeLazyImages(e.find("img[data-lazy]"))}}),observeLazyImages(e.find("img[data-lazy]"))}function loadLatestUpdatedPlayers(){let e=0;const a=$("#updated-players tbody"),t=function(e,a){return{"<>":"tr",class:e?"fade-green":"","data-app-id":"${id}","data-link":"${link}",html:[{"<>":"td",class:"img",html:[{"<>":"a",href:"${link}",class:"icon-name",html:[{"<>":"div",class:"icon",html:[{"<>":"img","data-lazy":"${avatar}",alt:"","data-lazy-alt":"${name}"}]},{"<>":"div",class:"name",html:"${name}"}]}]},{"<>":"td",nowrap:"nowrap",html:[{"<>":"span","data-livestamp":"${updated_at}",text:a?"a few seconds ago":""}]},{"<>":"td",html:[{"<>":"a",href:"${community_link}",target:"_blank",rel:"noopener",html:[{"<>":"i",class:"fas fa-link"}]}]}]}};$.ajax({url:"/home/updated-players.json",dataType:"json",cache:!0,success:function(r,n,s){isIterable(r)&&(a.find("tr").remove(),a.json2html(r,t(!1,!1),{prepend:!1}),observeLazyImages(a.find("img[data-lazy]"))),e=r[0].id}}),websocketListener("profile",function(r){const n=JSON.parse(r.data);"player"===n.Data.queue&&n.Data.id!==e&&(e=n.Data.id,a.json2html([n.Data],t(!0,!0),{prepend:!0}),a.find("tr").slice(10).remove(),observeLazyImages(a.find("img[data-lazy]")))})}function loadSales(e){$.ajax({url:"/home/sales/"+e+".json",dataType:"json",cache:!0,success:function(a,t,r){const n=$("#sales span[data-sort]");n.removeClass("badge-success"),n.addClass("cursor-pointer");const s=$('#sales span[data-sort="'+e+'"]');if(s.addClass("badge-success"),s.removeClass("cursor-pointer"),$("#sales tbody tr").remove(),$("#sales .change").html(e),isIterable(a)){const e=$("#sales tbody");e.json2html(a,{"<>":"tr","data-app-id":"${id}","data-link":"${link}",html:[{"<>":"td",class:"img",html:[{"<>":"a",href:"${link}",class:"icon-name",html:[{"<>":"div",class:"icon",html:[{"<>":"img","data-lazy":"${icon}",alt:"","data-lazy-alt":"${name}"}]},{"<>":"div",class:"name",html:"${name}"}]}]},{"<>":"td",html:"${price}",class:"nowrap"},{"<>":"td",html:"${rating}"},{"<>":"td",nowrap:"nowrap",class:"nowrap",html:[{"<>":"span","data-toggle":"tooltip","data-placement":"left","data-livestamp":"${ends}"}]},{"<>":"td",html:[{"<>":"a",href:"${store_link}",target:"_blank",rel:"noopener",html:[{"<>":"i",class:"fas fa-link"}]}]}]},{prepend:!1}),observeLazyImages(e.find("img[data-lazy]")),highLightOwnedGames($("#sales"))}}})}function loadPlayers(e){$.ajax({url:"/home/players/"+e+".json",dataType:"json",cache:!0,success:function(a,t,r){const n=$("#players span[data-sort]");n.removeClass("badge-success"),n.addClass("cursor-pointer");const s=$('#players span[data-sort="'+e+'"]');if(s.addClass("badge-success"),s.removeClass("cursor-pointer"),$("#players tbody tr").remove(),isIterable(a)){const t=$("#players tbody"),r=[{"<>":"td",class:"font-weight-bold",html:"${rank}"},{"<>":"td",class:"img",html:[{"<>":"a",href:"${link}",class:"icon-name",html:[{"<>":"div",class:"icon",html:[{"<>":"img","data-lazy":"${avatar}",alt:"","data-lazy-alt":"${name}"}]},{"<>":"div",class:"name",html:"${name}"}]}]}],n=$("#players .change1"),s=$("#players .change2");switch(e){case"level":r.push({"<>":"td",class:"img",html:'<div class="icon-name"><div class="icon"><div class="${class}"></div></div><div class="name min nowrap">${level}</div></div>'}),r.push({"<>":"td",nowrap:"nowrap",html:"${badges}"}),n.html("Level"),s.html("Badges");break;case"games":r.push({"<>":"td",nowrap:"nowrap",html:"${games}"}),r.push({"<>":"td",nowrap:"nowrap",html:"${playtime}"}),n.html("Games"),s.html("Playtime");break;case"bans":r.push({"<>":"td",nowrap:"nowrap",html:"${game_bans}"}),r.push({"<>":"td",nowrap:"nowrap",html:"${vac_bans}"}),n.html("Game Bans"),s.html("VAC Bans");break;case"profile":r.push({"<>":"td",nowrap:"nowrap",html:"${friends}"}),r.push({"<>":"td",nowrap:"nowrap",html:"${comments}"}),n.html("Friends"),s.html("Comments")}t.json2html(a,{"<>":"tr","data-link":"${link}",html:r},{prepend:!1}),observeLazyImages(t.find("img[data-lazy]"))}}})}a.each(function(){$(this).height()>e&&(e=$(this).height())}),a.css("min-height",e+"px"),loadAjaxOnObserve({players:function(){loadPlayers("level")},"updated-players":loadLatestUpdatedPlayers,news:loadNewsSection,tweets:loadHomeTweets})}if($("#info-page").length>0&&$("#questions "+window.location.hash).addClass("highlight"),$("#new-releases-page").length>0){const e={order:[[3,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img alt="" data-lazy="'+t[2]+'" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[5]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[7]+"%"},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[8].toLocaleString()},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[6]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:5,render:function(e,a,t){return'<div data-app-id="'+t[0]+'"><i class="fas fa-spinner fa-spin"></i></div>'},createdCell:function(e,a,t,r,n){$(e).addClass("chart")},orderSequence:["desc","asc"]}]};$("table.table").gdbTable({tableOptions:e,searchFields:[$("#search"),$("#days")]})}if($("#news-page").length>0){function loadNewsAjax(){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[3]),$(e).addClass("cursor-pointer")},columnDefs:[{targets:0,render:function(e,a,t){const r=t[11]+'<br><small><a href="'+t[9]+'">'+t[7]+"</a></small>";return'<div class="icon-name"><div class="icon"><img class="tall" alt="" src="" data-lazy="'+t[4]+'" data-lazy-alt="'+t[1]+'"></div><div class="name">'+r+'</div></div><div class="d-none">'+t[5]+"</div>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[10]+'" data-livestamp="'+t[5]+'"></span>'},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc"]},{targets:2,render:function(e,a,t){return t[6]},orderable:!1,visible:!1}]},a=$("#news-table"),t=a.gdbTable({tableOptions:e,searchFields:[$("#search")]});a.on("click","tbody tr[role=row]",function(){const e=$(this),a=t.row(e);a.child.isShown()?(a.child.hide(),e.removeClass("shown")):(a.child($("<div/>").html(a.data()[2])).show(),e.addClass("shown"))})}$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){const a=$(e.target);$(e.relatedTarget);if(!a.attr("loaded"))switch(a.attr("loaded",1),a.attr("href")){case"#all":loadNewsAjax()}}),$(".minned").on("click",function(e){$(this).toggleClass("minned")})}const $packagePage=$("#package-page");if($packagePage.length>0&&($('a[data-toggle="tab"]').on("shown.bs.tab",function(e){const a=$(e.target);$(e.relatedTarget);if(!a.attr("loaded"))switch(a.attr("loaded",1),a.attr("href")){case"#prices":loadPriceChart()}}),websocketListener("package",function(e){JSON.parse(e.data).Data.toString()===$packagePage.attr("data-id")&&toast(!0,"Click to refresh","This package has been updated",0,"refresh")})),$("#packages-page").length>0){$("select.form-control-chosen").chosen({disable_search_threshold:10,allow_single_deselect:!0,rtl:!1,max_selected_options:10});const e={order:[[5,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[1])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[1]+'" class="icon-name"><div class="icon"><img alt="" data-lazy="'+t[8]+'" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[2]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[5]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[9]},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[11]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:5,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[7]+'" data-livestamp="'+t[6]+'">'+t[7]+"</span>"},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc"]},{targets:6,render:function(e,a,t){return t[10]?'<a href="'+t[10]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]},a=[$("#status"),$("#platform"),$("#license"),$("#billing")],t=$("table.table"),r=t.gdbTable({tableOptions:e,searchFields:a});websocketListener("packages",function(a){const n=r.page.info();if(0===n.page){const r=JSON.parse(a.data);addDataTablesRow(e,r.Data,n.length,t)}})}const $playerPage=$("#player-page");if($playerPage.length>0){const e=$("#update-button");e.on("click",function(a){a.preventDefault(),$("i, svg",e).addClass("fa-spin"),$.ajax({url:"/players/"+$playerPage.attr("data-id")+"/update.json",data:{csrf:$(this).attr("data-csrf")},dataType:"json",cache:!1,success:function(a,t,r){toast(a.success,a.toast),e.contents().last()[0].textContent=" In Queue"}})});let a;function loadPlayerLibraryTab(){const e={order:[[2,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[7])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[7]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderSequence:["asc","desc"]},{targets:1,render:function(e,a,t){return t[5]},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[4]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[6]},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[9]>0?t[8].toLocaleString()+" / "+t[9].toLocaleString():"-"},createdCell:function(e,a,t,r,n){t[10]=Math.ceil(t[10]),$(e).css("background","linear-gradient(to right, rgba(0,0,0,.15) "+t[10]+"%, transparent "+t[10]+"%)"),$(e).addClass("thin")},orderSequence:["desc","asc"]}]};$("#all-games").gdbTable({tableOptions:e,searchFields:[$("#player-games-search")]})}function loadPlayerLibraryStatsTab(){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[5])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[5]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[1]+'" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[2]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")}},{targets:1,render:function(e,a,t){return t[3].toLocaleString()}},{targets:2,render:function(e,a,t){return t[4].toLocaleString()},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")}}]};$("#recent-games").gdbTable({tableOptions:e})}function loadPlayerDetailsTab(){$.ajax({type:"GET",url:"/players/"+$playerPage.attr("data-id")+"/history.json",dataType:"json",success:function(e,a,t){null===e&&(e={});const r={l:[{name:"Level",data:e.max_level,marker:{symbol:"circle"},yAxis:0},{name:"Level Rank",data:e.max_level_rank,marker:{symbol:"circle"},yAxis:1}],b:[{name:"Badges",data:e.max_badges,marker:{symbol:"circle"},yAxis:0},{name:"Badges Rank",data:e.max_badges_rank,marker:{symbol:"circle"},yAxis:1}],d:[{name:"Foil Badges",data:e.max_badges_foil,marker:{symbol:"circle"},yAxis:0},{name:"Foil Badges Rank",data:e.max_badges_foil_rank,marker:{symbol:"circle"},yAxis:1}],f:[{name:"Friends",data:e.max_friends,marker:{symbol:"circle"},yAxis:0},{name:"Friends Rank",data:e.max_friends_rank,marker:{symbol:"circle"},yAxis:1}],c:[{name:"Comments",data:e.max_comments,marker:{symbol:"circle"},yAxis:0},{name:"Comments Rank",data:e.max_comments_rank,marker:{symbol:"circle"},yAxis:1}],g:[{name:"Games",data:e.max_games,marker:{symbol:"circle"},yAxis:0},{name:"Games Rank",data:e.max_games_rank,marker:{symbol:"circle"},yAxis:1}],p:[{name:"Playtime",data:e.max_playtime,marker:{symbol:"circle"},yAxis:0},{name:"Playtime Rank",data:e.max_playtime_rank,marker:{symbol:"circle"},yAxis:1}],a:[{name:"Achievements",data:e.max_achievements,marker:{symbol:"circle"},yAxis:0},{name:"Achievements Rank",data:e.max_achievements_rank,marker:{symbol:"circle"},yAxis:1}]};for(let e in r)r.hasOwnProperty(e)&&Highcharts.chart(e+"-chart",$.extend(!0,{},defaultChartOptions,{legend:{enabled:!1},yAxis:[{labels:{enabled:!1}},{allowDecimals:!1,title:{text:""},reversed:!0,min:1}],tooltip:{outside:!0,formatter:function(){switch(this.series.name){case"Level":case"Badges":case"Foil Badges":case"Friends":case"Comments":case"Games":case"Achievements":return this.y.toLocaleString()+" "+this.series.name+" on "+moment(this.key).format("dddd DD MMM YYYY");case"Playtime":return this.y.toLocaleString()+" minutes played on "+moment(this.key).format("dddd DD MMM YYYY");default:return this.series.name+this.y.toLocaleString()+" on "+moment(this.key).format("dddd DD MMM YYYY")}}},series:r[e]}))}})}function loadPlayerBadgesTab(){const e={order:[[1,"desc"]],createdRow:function(e,a,t){a[0]&&$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[2])},columnDefs:[{targets:0,render:function(e,a,t){let r=t[1];return t[9]&&(r+='<span class="badge badge-primary float-right ml-1">Special</span>'),t[10]&&(r+='<span class="badge badge-warning float-right ml-1">Event</span>'),t[4]&&(r+='<span class="badge badge-success float-right ml-1">Foil</span>'),'<a href="'+t[2]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[5]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+r+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[6].toLocaleString()+" ("+t[8].toLocaleString()+"xp)"},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[7].toLocaleString()},orderSequence:["asc","desc"]},{targets:3,render:function(e,a,t){return t[3].toLocaleString()},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]}]};$("#badges-table").gdbTable({tableOptions:e,searchFields:[$("#player-badge-search")]})}function loadPlayerFriendsTab(){const e={order:[[1,"desc"],[4,"asc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[1])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[1]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" data-src="/assets/img/no-player-image.jpg" alt="" data-lazy-alt="'+t[3]+'"></div><div class="name">'+t[3]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return""!==t[4]&&"-"!==t[4]||$("#add-missing-friends").removeClass("d-none"),t[4].toLocaleString()},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[5]?0===t[6]?$lockIcon:t[6].toLocaleString():"-"},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[6]>0?'<a href="/games/coop/'+$playerPage.attr("data-id")+","+t[0]+'">Co-op</a>':""},orderable:!1},{targets:4,render:function(e,a,t){return t[7]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["asc","desc"]},{targets:5,render:function(e,a,t){return t[8]?'<a href="'+t[8]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("#friends-table").gdbTable({tableOptions:e})}function loadPlayerGroupsTab(){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[3]),$(e).attr("data-group-id",a[0])},columnDefs:[{targets:0,render:function(e,a,t){let r="";return t[7]&&(r='<span class="badge badge-success float-right">Primary</span>'),'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[4]+'" data-src="/assets/img/no-player-image.jpg" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[2]+r+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderSequence:["asc"]},{targets:1,render:function(e,a,t){return t[5].toLocaleString()},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return"game"===t[6]?'<i class="fas fa-gamepad text-primary"></i> Game':"group"===t[6]?'<i class="fas fa-user-friends text-success"></i> Group':""},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(e,a,t){return t[8]?'<a href="'+t[8]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("#groups-table").gdbTable({tableOptions:e})}function loadPlayerWishlistTab(){const e={order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[2])},columnDefs:[{targets:0,render:function(e,a,t){return 0===t[4]?"-":ordinal(t[4])},createdCell:function(e,a,t,r,n){$(e).addClass("font-weight-bold")},orderSequence:["asc"]},{targets:1,render:function(e,a,t){return'<a href="'+t[2]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[3]+'" data-src="/assets/img/no-player-image.jpg" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderSequence:["asc"]},{targets:2,render:function(e,a,t){return t[5]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(e,a,t){return t[6]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[7]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]}]};$("#wishlist-table").gdbTable({tableOptions:e})}function loadPlayerAchievementsTab(){$.ajax({type:"GET",url:"/players/"+$playerPage.attr("data-id")+"/achievement-days.json",dataType:"json",success:function(e,a,t){null===e&&(e=[]),$("#achievement-days-chart").empty().calmosaic(e)}});const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[0]+"#achievements")},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[0]+'#achievements" class="icon-name"><div class="icon"><img class="tall" data-lazy="'+t[4]+'" alt="" data-lazy-alt="'+t[3]+'"></div><div class="name">'+t[1]+": "+t[3]+"<br><small>"+t[5]+"</small></div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[6]?'<span data-livestamp="'+t[6]+'"></span><br><small class="text-muted">'+t[8]+"</small>":"Unknown"},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[7]+"%"},createdCell:function(e,a,t,r,n){t[7]=Math.ceil(t[7]),$(e).css("background","linear-gradient(to right, rgba(0,0,0,.15) "+t[7]+"%, transparent "+t[7]+"%)"),$(e).addClass("thin")},orderSequence:["asc","desc"]}]};$("#achievements-table").gdbTable({tableOptions:e})}websocketListener("profile",async function(t){const r=JSON.parse(t.data);if(r.Data.id===$playerPage.attr("data-id")){if("player"===r.Data.queue){a=toast(!0,'<ul><li data-queue="player">Details</li><li data-queue="achievement">Achievements</li><li data-queue="alias">Aliases</li><li data-queue="badge">Badges</li><li data-queue="game">Games</li><li data-queue="group">Groups</li><li data-queue="wishlist">Wishlist</li></ul>',"Player Updating",-1,"refresh")}a&&(a.find('[data-queue="'+r.Data.queue+'"]').addClass("line-through"),0===a.find("li:not(.line-through)").length&&a.find(".toast-message").html("Click to refresh!")),$("i, svg",e).removeClass("fa-spin","fa-sync-alt").addClass("fa-check"),e.contents().last()[0].textContent=" Updated",e.off(),e.removeAttr("href")}}),loadAjaxOnObserve({"all-games":loadPlayerLibraryTab,"recent-games":loadPlayerLibraryStatsTab,details:loadPlayerDetailsTab,"badges-table":loadPlayerBadgesTab,"friends-table":loadPlayerFriendsTab,"groups-table":loadPlayerGroupsTab,"wishlist-table":loadPlayerWishlistTab,"achievements-table":loadPlayerAchievementsTab})}const $playerMissingPage=$("#player-missing-page");if($playerMissingPage.length>0){function updateLoadingBar(){if(queue_current>0){let e=0;queue_start>0&&(e=100-queue_current/queue_start*100);let a=queue_current.toLocaleString()+" / "+queue_start.toLocaleString();$(".progress .progress-bar").html(a).width(e+"%")}else $(".progress .progress-bar").html("You're Next!").width("100%")}websocketListener("profile",function(e){queue_current>0&&queue_current--,updateLoadingBar();const a=JSON.parse(e.data);"player"===a.Data.queue&&a.Data.id===$playerMissingPage.attr("data-id")&&(toast(!0,"","Player found!"),location.reload())}),updateLoadingBar()}if($("#players-page").length>0){const e=$("#search"),a=$("#country"),t=$("#state"),r=$("#state-container");function toggleStateDropDown(){const e=a.val();e.startsWith("c-")?r.hide():$.ajax({type:"GET",url:"/players/states.json?cc="+e,dataType:"json",success:function(e,a,n){!e||e.length<=3?r.hide():(t.empty(),$.each(e,function(e,a){let r={value:a.k,text:a.v};"---"===a.v&&(r.disabled="disabled"),t.append($("<option/>",r))}),t.val(""),r.show())}})}a.on("change",function(e){toggleStateDropDown()});const n={language:{zeroRecords:function(){return'Players can be searched for using their username or vanity URL. If a player is missing, <a href="/players/add?search='+e.val()+'">add them here</a>.'}},order:[getOrder(window.location.hash)],createdRow:function(e,a,t){$(e).attr("data-link",a[13])},columnDefs:[{targets:0,render:function(e,a,t){return t[0]},createdCell:function(e,a,t,r,n){$(e).addClass("font-weight-bold")},orderable:!1},{targets:1,render:function(e,a,t){if(t[11]){const e='<img data-lazy="'+t[11]+'" alt="" data-lazy-alt="'+t[12]+'" class="wide" data-toggle="tooltip" data-placement="left" data-lazy-title="'+t[12]+'">';return'<a href="/players?country='+t[19]+'">'+e+"</a>"}return""},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:2,render:function(e,a,t){return'<a href="'+t[13]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[3]+'" alt="" data-lazy-alt="'+t[2]+'"></div><div class="name">'+t[23]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:3,render:function(e,a,t){return'<div class="icon-name"><div class="icon"><div class="'+t[4]+'"></div></div><div class="name min nowrap">'+t[5].toLocaleString()+"</div></div>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderSequence:["desc"]},{targets:4,render:function(e,a,t){return t[7].toLocaleString()},orderSequence:["desc"]},{targets:5,render:function(e,a,t){return t[6]?t[6].toLocaleString():$lockIcon},orderSequence:["desc"]},{targets:6,render:function(e,a,t){return"-"===t[8]?$lockIcon:t[8]},createdCell:function(e,a,t,r,n){if("-"!==t[8]){const a=$(e);a.attr("nowrap","nowrap"),a.attr("data-toggle","tooltip"),a.attr("data-placement","left"),a.attr("title",t[9])}},orderSequence:["desc"]},{targets:7,render:function(e,a,t){return t[15].toLocaleString()},orderSequence:["desc"]},{targets:8,render:function(e,a,t){return t[16].toLocaleString()},orderSequence:["desc"]},{targets:9,render:function(e,a,t){return t[17]>0?'<span data-toggle="tooltip" data-placement="left" title="'+t[18]+'" data-livestamp="'+t[17]+'"></span>':""},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc"]},{targets:10,render:function(e,a,t){return 0===t[10]?$lockIcon:t[10].toLocaleString()},orderSequence:["desc"],visible:!1},{targets:11,render:function(e,a,t){return t[20].toLocaleString()},orderSequence:["desc"],visible:!1},{targets:12,render:function(e,a,t){return t[21].toLocaleString()},orderSequence:["desc"]},{targets:13,render:function(e,a,t){return t[22].toLocaleString()},orderSequence:["desc"]},{targets:14,render:function(e,a,t){return t[25].toLocaleString()},orderSequence:["desc"]},{targets:15,render:function(e,a,t){return t[14]?'<a href="'+t[14]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1},{targets:16,render:function(e,a,t){return t[24]},orderable:!1,visible:!1}]};let s=[a,e,t];const o=$("table.table").gdbTable({tableOptions:n,searchFields:s});function getOrder(a){const t=$("[data-col-sort]").attr("data-col-sort");if(e.val()&&t)return[parseInt(t),"desc"];switch(a){case"#games":return[5,"desc"];case"#bans":return[7,"desc"];case"#profile":return[10,"desc"];case"#achievements":return[12,"desc"];default:return[3,"desc"]}}function updateColumns(e,a){a||(a="#level"),$('#player-nav a[href="'+a+'"]').tab("show");let t=[],r=[];switch(a){case"#level":r=[3,4,14],t=[5,6,7,8,9,10,11,12,13];break;case"#games":r=[5,6],t=[3,4,7,8,9,10,11,12,13,14];break;case"#bans":r=[7,8,9],t=[3,4,5,6,7,8,9,10,11,12,13,14];break;case"#profile":r=[10,11],t=[3,4,5,6,7,8,9,10,11,12,13,14];break;case"#achievements":r=[12,13],t=[3,4,5,6,7,8,9,10,11,14]}e.columns(t).visible(!1,!1),e.columns(r).visible(!0,!1),e.columns.adjust(),JSON.stringify(e.order())!==JSON.stringify([getOrder(a)])&&(e.order([getOrder(a)]),e.draw());const n=e.table().container();observeLazyImages($(n).find("img[data-lazy]"))}$('#player-nav a[href^="#"]').on("click",function(e){e.preventDefault();const a=$(this).attr("href");window.location.hash=a,updateColumns(o,a)}),updateColumns(o,window.location.hash),toggleStateDropDown()}if($("#price-changes-page").length>0){$("select.form-control-chosen").chosen({disable_search_threshold:10,allow_single_deselect:!0,rtl:!1,max_selected_options:10});const e=$("#change-low").val(),a=$("#change-high").val(),t=$("#change-slider"),r=noUiSlider.create(t[0],{start:[parseInt(e||-100),parseInt(a||100)],connect:!0,step:1,range:{min:-100,max:100}}),n=$("#price-low").val(),s=$("#price-high").val(),o=$("#price-slider"),l=noUiSlider.create(o[0],{start:[parseInt(n||-100),parseInt(s||100)],connect:!0,step:1,range:{min:0,max:100}});function updateLabels(e){const a=r.get();a[0]===a[1]?$("label#change-label").html("Price Change Percent ("+Math.round(a[0])+"%)"):$("label#change-label").html("Price Change Percent ("+Math.round(a[0])+"% - "+Math.round(a[1])+"%)");const t=l.get();t[0]===t[1]?$("label#price-label").html("Final Price ("+user.userCurrencySymbol+Math.round(t[0])+")"):$("label#price-label").html("Final Price ("+user.userCurrencySymbol+Math.round(t[0])+" - "+user.userCurrencySymbol+Math.round(t[1])+")")}window.updateLabels=updateLabels,$(updateLabels),$typeField=$("#type");const i={order:[[4,"desc"]],createdRow:function(e,a,t){let r;$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[5]),a[9]?(r=Math.min(a[9],100),r+=100,r/=2):r=100,$(e).addClass("col-grad-"+Math.round(r))},columnDefs:[{targets:0,render:function(e,a,t){let r=t[3];return"all"===$typeField.val()&&(t[0]>0?r+=' <span class="badge badge-success float-right">App</span>':t[1]>0&&(r+=' <span class="badge badge-success float-right">Package</span>')),'<a href="'+t[5]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[4]+'" alt="" data-lazy-alt="'+t[3]+'"></div><div class="name">'+r+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[6]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[7]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(e,a,t){const r="<small>"+t[9]+"%</small>";return 0===t[9]?t[8]+" <small>∞%</small> ":t[8]+" "+r},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:4,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[10]+'" data-livestamp="'+t[11]+'">'+t[10]+"</span>"},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1}]},c=[$typeField,t,o],d=$("table.table"),u=d.gdbTable({tableOptions:i,searchFields:c});websocketListener("prices",function(e){const a=u.page.info();if(0===a.page){const t=JSON.parse(e.data),r=$typeField.val();t.Data[13]===user.prodCC&&("all"===r||"apps"===r&&t.Data[0]>0||"packages"===r&&t.Data[1]>0)&&addDataTablesRow(i,t.Data,a.length,d)}})}if($("#product-keys-page").length>0){const e={order:[[0,"asc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img src="'+t[2]+'" alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")}},{targets:1,render:function(e,a,t){return t[4]},orderable:!1}]},a=$("#search-table").gdbTable({tableOptions:e,searchFields:[$("#key"),$("#value"),$("input[name=type]")]});$("#search button").on("click",function(e){a.draw()});const t=$("#table-search");$("#apps-table").gdbTable({searchFields:[t]}),$("#packages-table").gdbTable({searchFields:[t]}),$("#apps-table tbody tr").on("click",function(e){$("#key").val($(this).attr("data-key")),$("input[name=type][value=apps]").prop("checked",!0),$('a.nav-link[href="#search"]').tab("show")}),$("#packages-table tbody tr").on("click",function(e){$("#key").val($(this).attr("data-key")),$("input[name=type][value=packages]").prop("checked",!0),$('a.nav-link[href="#search"]').tab("show")})}if($("#queues-page").length>0||$("#player-missing-page").length>0){let e=!0;$(window).on("focus",function(){e=!0}),$(window).on("blur",function(){e=!1});const a={};$("[data-queue]").each(function(e,t){a[$(this).attr("data-queue")]=loadChart($(this).attr("id"))}),updateCharts();const t=window.setInterval(updateCharts,1e4);let r=!0;function updateCharts(){e&&$.ajax({url:"/queues/queues.json",dataType:"json",cache:!1,success:function(e,t,n){$.each(a,function(a,t){let n=0;for(let s in e)e.hasOwnProperty(s)&&s.startsWith("GDB_"+a)&&(r?t.addSeries({name:s,data:e[s].sum_messages}):t.series[n].setData(e[s].sum_messages),n++)}),r=!1,$("#live-badge").addClass("badge-success").removeClass("badge-secondary badge-danger")},error:function(e,a,r){clearTimeout(t),$("#live-badge").addClass("badge-danger").removeClass("badge-secondary badge-success"),toast(!1,"Live functionality has stopped")}})}function loadChart(e){return Highcharts.chart(e,$.extend(!0,{},defaultChartOptions,{chart:{animation:!1},legend:{enabled:!1},xAxis:{labels:{step:1,formatter:function(){return moment(this.value).format("h:mm")}}},yAxis:{title:{text:""},allowDecimals:!1,min:0},plotOptions:{series:{marker:{enabled:!1},animation:!1}},series:[],tooltip:{formatter:function(){return this.y.toLocaleString()+" items in "+this.series.name.replace(/^GDB_/,"")+" at "+moment(this.key).format("h:mm")}}}))}}function recaptchaCallback(e){$("form[data-recaptcha] button[type=submit]").prop("disabled",!1);const a=$("form[data-recaptcha] input[type=text], form input[type=email], form textarea").filter(function(){return""===$(this).val()});a.length>0&&a.get(0).focus()}$("#sales-page").length>0&&function(e,a){"use strict";const t=e("#clock"),r=t.attr("data-time");t.countdown(r,function(a){e(this).html(a.strftime("%D:%H:%M:%S"))}),e("select.form-control-chosen").chosen({disable_search_threshold:10,allow_single_deselect:!0,rtl:!1,max_selected_options:10});const n=e("#price-slider"),s=noUiSlider.create(n[0],{start:[0,100],connect:!0,step:1,range:{min:0,max:100}}),o=e("#score-slider"),l=noUiSlider.create(o[0],{start:[0,100],connect:!0,step:1,range:{min:0,max:100}}),i=e("#discount-slider"),c=noUiSlider.create(i[0],{start:[0,100],connect:!0,step:1,range:{min:0,max:100}}),d=e("#index-slider"),u=parseInt(d.attr("data-max")),p=noUiSlider.create(d[0],{start:u+1,connect:!0,step:1,range:{min:1,max:u+1}});function m(a){const t=s.get();t[0]===t[1]?e("label#price-label").html("Price ("+user.userCurrencySymbol+Math.round(t[0])+")"):e("label#price-label").html("Price ("+user.userCurrencySymbol+Math.round(t[0])+" to "+user.userCurrencySymbol+Math.round(t[1])+")");const r=l.get();r[0]===r[1]?e("label#score-label").html("Score ("+Math.round(r[0])+"%)"):e("label#score-label").html("Score ("+Math.round(r[0])+"% to "+Math.round(r[1])+"%)");const n=c.get();n[0]===n[1]?e("label#discount-label").html("Discount (-"+Math.round(n[0])+"%)"):e("label#discount-label").html("Discount (-"+Math.round(n[0])+"% - to -"+Math.round(n[1])+"%)"),e("label#index-label").html("Max Per Game ("+Math.trunc(p.get())+")")}window.updateLabels=m,e(m);const g={order:[[3,"desc"]],createdRow:function(a,t,r){e(a).attr("data-link",t[3]),e(a).attr("data-app-id",t[0])},columnDefs:[{targets:0,render:function(e,a,t){let r=t[1];return r=r+" <br /><small>"+t[13]+" / "+t[10]+"</small>",1===t[11]?r+=' <span class="badge badge-success float-right">Equal lowest</span>':2===t[11]&&(r+=' <span class="badge badge-success float-right">Lowest Ever!</span>'),null!=t[15]&&t[15].includes(777)&&(r+=' <span class="badge badge-success float-right">Low Confidence</span>'),'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img class="tall" data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+r+"</div></a>"},createdCell:function(a,t,r,n,s){e(a).addClass("img")}},{targets:1,render:function(e,a,t){return t[4]?t[4]:"-"},orderSequence:["asc","desc"]},{targets:2,render:function(e,a,t){return t[5]+"%"},orderSequence:["asc"]},{targets:3,render:function(e,a,t){return t[6]},orderSequence:["desc"]},{targets:4,render:function(e,a,t){let r='<span data-toggle="tooltip" data-placement="left" title="'+t[7]+'" data-livestamp="'+t[7]+'"></span>';return t[11]&&(r+="*"),r},createdCell:function(a,t,r,n,s){e(a).attr("nowrap","nowrap")},orderSequence:["asc"]},{targets:5,render:function(e,a,t){return t[9].startsWith("1970-01-01")?t[14]:'<span data-toggle="tooltip" data-placement="left" title="'+t[9]+'" data-livestamp="'+t[9]+'"></span>'},createdCell:function(a,t,r,n,s){e(a).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:6,render:function(e,a,t){return t[8]?'<a href="'+t[8]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]},f=(new URL(window.location).searchParams,e("#platforms")),h=e("#app-type"),b=[e("#search"),e("#tags-in"),e("#tags-out"),e("#categories"),e("#sale-type"),h,f,n,o,i,d];e("table.table").gdbTable({tableOptions:g,searchFields:b})}(jQuery,document);const $settingsPage=$("#settings-page");if(($settingsPage.length>0||$("#signup-page").length>0)&&$("#password-container input:password").pwstrength(),$settingsPage.length>0){function loadEvents(){$("select.form-control-chosen").chosen({disable_search_threshold:10,allow_single_deselect:!0,rtl:!1}),$("#events table.table").gdbTable({searchFields:[$("#type")],tableOptions:{order:[[0,"desc"]],columnDefs:[{targets:0,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[1]+'" data-livestamp="'+t[0]+'">'+t[1]+"</span>"},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,a,t){return'<i class="fas '+t[7]+'"></i> '+t[2]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[3]===t[6]?'<span class="font-weight-bold" data-toggle="tooltip" data-placement="left" title="Your current IP">'+t[8]+"</span>":t[8]},orderable:!1},{targets:3,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[4]+'">'+t[5]+"</span>"},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1}]}})}function loadDonations(){$("#donations table.table").gdbTable({tableOptions:{order:[[0,"desc"]],columnDefs:[{targets:0,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[1]+'" data-livestamp="'+t[0]+'">'+t[1]+"</span>"},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:1,render:function(e,a,t){return"$ "+(t[2]/100).toLocaleString()},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:2,render:function(e,a,t){return t[3]},orderable:!1}]}})}loadAjaxOnObserve({"events-table":loadEvents,"donations-table":loadDonations})}const $statPage=$("#stat-page");if($statPage.length>0){function statTable(){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[8]),$(e).attr("data-player-id",a[0])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc"]},{targets:2,render:function(e,a,t){return t[5]},orderSequence:["desc"]},{targets:3,render:function(e,a,t){return t[6]},orderSequence:["desc"]},{targets:4,render:function(e,a,t){return t[7]?'<a href="'+t[7]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("#games").gdbTable({tableOptions:e,searchFields:[$("#items-search")]})}function statHighChart(){$.ajax({type:"GET",url:"/"+$statPage.attr("data-stat-type")+"/"+$statPage.attr("data-stat-id")+"/time.json",dataType:"json",success:function(e,a,t){null===e&&(e=[]);const r={allowDecimals:!1,title:{text:""},labels:{enabled:!1}};Highcharts.chart("stat-chart",$.extend(!0,{},defaultChartOptions,{yAxis:[r,r,r,r,r],tooltip:{formatter:function(){const e=moment(this.key).format("dddd DD MMM YYYY");switch(this.series.name){case"Apps":return Math.round(this.y).toLocaleString()+" games with tag on "+e;case"Apps (%)":return this.y.toLocaleString()+"% of games have tag "+e;case"Mean Players":return this.y.toLocaleString()+" mean max weakly players on "+e;case"Mean Price ("+user.userCurrencySymbol+")":return user.userCurrencySymbol+" "+(this.y/100).toFixed(2).toLocaleString()+" mean price on "+e;case"Mean Review Score":return this.y.toLocaleString()+"% mean review score on "+e;case"Median Players":return this.y.toLocaleString()+" median max weakly players on "+e;case"Median Price ("+user.userCurrencySymbol+")":return user.userCurrencySymbol+" "+(this.y/100).toFixed(2).toLocaleString()+" median price on "+e;case"Median Review Score":return this.y.toLocaleString()+"% median review score on "+e}}},series:[{name:"Apps",data:e.max_apps_count,marker:{symbol:"circle"},yAxis:0},{name:"Apps (%)",data:e.max_apps_percent,marker:{symbol:"circle"},yAxis:1},{name:"Mean Players",data:e.max_mean_players,marker:{symbol:"circle"},yAxis:2},{name:"Median Players",data:e.max_median_players,marker:{symbol:"circle"},yAxis:2,visible:!1},{name:"Mean Price ("+user.userCurrencySymbol+")",data:e["max_mean_price_"+user.prodCC],marker:{symbol:"circle"},yAxis:3},{name:"Median Price ("+user.userCurrencySymbol+")",data:e["max_median_price_"+user.prodCC],marker:{symbol:"circle"},yAxis:3,visible:!1},{name:"Mean Review Score",data:e.max_mean_score,marker:{symbol:"circle"},yAxis:4},{name:"Median Review Score",data:e.max_median_score,marker:{symbol:"circle"},yAxis:4,visible:!1}]}))}})}loadAjaxOnObserve({"stat-chart":statHighChart,games:statTable})}if($("#stats-page").length>0&&function(e,a){"use strict";loadAjaxOnObserve({"client-players":function(){e.ajax({type:"GET",url:"/stats/client-players.json",dataType:"json",success:function(a,t,r){null===a&&(a=[]),Highcharts.chart("client-players",e.extend(!0,{},defaultChartOptions,{yAxis:{allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){const e=moment(this.key).format("dddd DD MMM YYYY @ HH:mm");return"Ingame"===this.series.name?this.y.toLocaleString()+" people in a game on "+e:this.y.toLocaleString()+" people online on "+e}},series:[{name:"In Game",marker:{symbol:"circle"},data:a.max_player_count,type:"area"},{name:"Online",marker:{symbol:"circle"},data:a.max_player_online,type:"line"}]}))}})},"client-players2":function(){e.ajax({type:"GET",url:"/stats/client-players2.json",dataType:"json",success:function(a,t,r){null===a&&(a=[]),Highcharts.chart("client-players2",e.extend(!0,{},defaultChartOptions,{chart:{zoomType:"x"},yAxis:{allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){const e=moment(this.key).format("dddd DD MMM YYYY");return"In Game"===this.series.name?this.y.toLocaleString()+" people in a game on "+e:this.y.toLocaleString()+" people online on "+e}},series:[{name:"In Game",marker:{symbol:"circle"},data:a.max_player_count,type:"area"},{name:"Online",marker:{symbol:"circle"},data:a.max_player_online,type:"line"}]}))}})},scores:function(){e.ajax({type:"GET",url:"/stats/app-scores.json",dataType:"json",success:function(t,r,n){null===t&&(t=[]),Highcharts.chart("scores-chart",e.extend(!0,{},defaultChartOptions,{chart:{type:"column"},legend:{enabled:!1},xAxis:{type:"category",tickInterval:5},yAxis:{allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){return this.y.toLocaleString()+" apps have "+this.x+"/100"}},plotOptions:{series:{pointPadding:0,groupPadding:0,cursor:"pointer",point:{events:{click:function(){a.location.href="/games?score="+this.x+"&score="+(this.x+1)}}}}},series:[{data:t}]}))}})},"release-dates":function(){e.ajax({type:"GET",url:"/stats/release-dates.json",dataType:"json",success:function(a,t,r){null===a&&(a=[]),Highcharts.chart("release-dates-chart",e.extend(!0,{},defaultChartOptions,{chart:{zoomType:"x"},legend:{enabled:!1},yAxis:{allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){return this.y.toLocaleString()+" apps released on "+moment(this.key).format("dddd DD MMM YYYY")}},series:[{data:a}]}))}})},"app-types":function(){e.ajax({type:"GET",url:"/stats/app-types.json",dataType:"json",cache:!0,success:function(a,t,r){const n=e("#app-types-table tbody");n.empty(),n.json2html(a.rows,{"<>":"tr","data-link":"/games?types=${type}",html:[{"<>":"td",html:"${typef}"},{"<>":"td",html:"${countf}"},{"<>":"td",html:"${totalf}"}]},{prepend:!1}),e("#total-price").text(a.total),e("#app-types-table").gdbTable()}})},"player-countries":function(){e.ajax({type:"GET",url:"/stats/player-countries.json",dataType:"json",success:function(a,t,r){Highcharts.chart("player-countries-chart",e.extend(!0,{},defaultChartOptions,{chart:{type:"column"},legend:{enabled:!1},xAxis:{type:"category"},yAxis:{type:"logarithmic",title:null},plotOptions:{series:{pointPadding:0,groupPadding:0}},series:[{data:a.series}],drilldown:{series:a.drilldown}}))}})},"player-levels":function(){e.ajax({type:"GET",url:"/stats/player-levels.json",dataType:"json",success:function(a,t,r){let n=[],s=[];a.forEach(function(e,t,r){n.push(a[t].id),s.push(e.count)}),Highcharts.chart("player-levels-chart",e.extend(!0,{},defaultChartOptions,{chart:{type:"column"},legend:{enabled:!1},xAxis:{type:"category",tickInterval:5,categories:n},yAxis:{type:"logarithmic",allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){return this.y.toLocaleString()+" players are level "+this.x+"-"+(this.x+9)}},plotOptions:{series:{pointPadding:0,groupPadding:0}},series:[{data:s}]}))}})},"player-update-days":function(){e.ajax({type:"GET",url:"/stats/player-update-dates.json",dataType:"json",success:function(a,t,r){null===a&&(a=[]),Highcharts.chart("player-update-days-chart",e.extend(!0,{},defaultChartOptions,{chart:{type:"column"},legend:{enabled:!1},yAxis:{allowDecimals:!1,title:{text:""}},tooltip:{formatter:function(){return this.y.toLocaleString()+" players updated on "+moment(this.x).format("dddd DD MMM YYYY")}},plotOptions:{series:{pointPadding:0,groupPadding:0}},series:[{data:a}]}))}})}})}(jQuery,window),$("#stats-list-page").length>0&&function(e,a){"use strict";const t={order:[[1,"desc"]],createdRow:function(a,t,r){e(a).attr("data-link",t[0])},columnDefs:[{targets:0,render:function(e,a,t){return'<i class="fas fa-star"></i> <span class="markable">'+t[1]+"</span>"},createdCell:function(a,t,r,n,s){e(a).attr("nowrap","nowrap")},orderSequence:["asc","desc"]},{targets:1,render:function(e,a,t){return t[2].toLocaleString()},orderSequence:["desc","asc"]},{targets:2,render:function(e,a,t){return t[3]},createdCell:function(a,t,r,n,s){e(a).attr("nowrap","nowrap")},orderSequence:["desc","asc"]},{targets:3,render:function(e,a,t){return t[5]},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc","asc"]}]};e("table.table").gdbTable({tableOptions:t,searchFields:[e("#search"),e("#type")]})}(jQuery,window),$("#upcoming-page").length>0&&$("table.table").gdbTable({searchFields:[$("#search")],tableOptions:{order:[[3,"asc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},drawCallback:function(e){const a=this.api();if(a.order()[0]&&3===a.order()[0][0]){const e=a.rows({page:"current"}).nodes();let t=null;a.rows().every(function(a,r,n){let s=this.data()[6];t!==s&&($(e).eq(a).before('<tr class="table-success"><td colspan="6">'+s+"</td></tr>"),t=s)})}},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[7]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["desc"]},{targets:2,render:function(e,a,t){return t[4]},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderable:!1},{targets:3,render:function(e,a,t){return'<span data-toggle="tooltip" data-placement="left" title="'+t[10]+'" data-livestamp="'+t[9]+'"></span>'},createdCell:function(e,a,t,r,n){$(e).attr("nowrap","nowrap")},orderSequence:["asc","desc"]},{targets:4,render:function(e,a,t){return t[8]?'<a href="'+t[8]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]}}),$("#wishlists-page").length>0){const e={order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-app-id",a[0]),$(e).attr("data-link",a[3])},columnDefs:[{targets:0,render:function(e,a,t){return'<a href="'+t[3]+'" class="icon-name"><div class="icon"><img data-lazy="'+t[2]+'" alt="" data-lazy-alt="'+t[1]+'"></div><div class="name">'+t[1]+"</div></a>"},createdCell:function(e,a,t,r,n){$(e).addClass("img")},orderable:!1},{targets:1,render:function(e,a,t){return t[4].toLocaleString()},orderSequence:["desc"]},{targets:2,render:function(e,a,t){return t[5].toLocaleString()},orderSequence:["asc","desc"]},{targets:3,render:function(e,a,t){return t[6]},orderSequence:["desc","asc"]},{targets:4,render:function(e,a,t){return t[10]},orderSequence:["desc","asc"]},{targets:5,render:function(e,a,t){return t[9]},orderSequence:["asc","desc"]},{targets:6,render:function(e,a,t){return t[7]?'<a href="'+t[7]+'" target="_blank" rel="noopener"><i class="fas fa-link"></i></a>':""},orderable:!1}]};$("#apps table.table").gdbTable({tableOptions:e,searchFields:[$("#search")]});const a={pageLength:1e3,order:[[1,"desc"]],createdRow:function(e,a,t){$(e).attr("data-link",a[2])},columnDefs:[{targets:0,render:function(e,a,t){return'<i class="fas fa-tag"></i> '+t[1]}},{targets:1,render:function(e,a,t){return t[3].toLocaleString()}}]};$("#tags table.table").gdbTable({tableOptions:a})}